<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lesson 2: Du Bois Does Data - Seeing the Story of the Color Line</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

@font-face { font-family: 'VTC Du Bois'; src: url('VTC Du Bois Desktop/TTF/Upright/VTCDuBois-Regular.ttf') format('truetype'); font-weight: 400; font-style: normal; }
@font-face { font-family: 'VTC Du Bois'; src: url('VTC Du Bois Desktop/TTF/Upright/VTCDuBois-Bold.ttf') format('truetype'); font-weight: 700; font-style: normal; }
@font-face { font-family: 'VTC Du Bois'; src: url('VTC Du Bois Desktop/TTF/Upright/VTCDuBois-Light.ttf') format('truetype'); font-weight: 300; font-style: normal; }
@font-face { font-family: 'VTC Du Bois'; src: url('VTC Du Bois Desktop/TTF/Italic/VTCDuBois-Italic.ttf') format('truetype'); font-weight: 400; font-style: italic; }
@font-face { font-family: 'VTC Du Bois'; src: url('VTC Du Bois Desktop/TTF/Italic/VTCDuBois-BoldItalic.ttf') format('truetype'); font-weight: 700; font-style: italic; }
:root{--crimson:#8B1A1A;--gold:#C5A55A;--dark-gold:#B8960C;--black:#1a1a1a;--dark-green:#2D5A3D;--parchment:#F5F0E8;--warm-bg:#D4C5A0;--tan:#E8DCC8;--brown:#6B4226;--red-accent:#C41E3A;--yellow:#E8C840}
*{margin:0;padding:0;box-sizing:border-box}
html{scroll-behavior:smooth}
body{font-family:'Inter',sans-serif;background:var(--tan);color:var(--black);line-height:1.6}

/* NAV */
nav{position:fixed;top:0;width:100%;z-index:1000;background:rgba(26,26,26,0.97);backdrop-filter:blur(10px)}
.nav-inner{max-width:1200px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;padding:0 20px;height:56px}
.nav-brand{font-family:'VTC Du Bois',serif;color:var(--gold);font-size:1.1rem;font-weight:700;text-decoration:none}
.nav-right{display:flex;align-items:center;gap:12px}
.nav-home{color:#aaa;text-decoration:none;font-size:.82rem;font-weight:600;padding:6px 12px;border-radius:4px;transition:.3s}
.nav-home:hover{color:var(--gold);background:rgba(197,165,90,.1)}
.mode-toggle{background:var(--gold);color:var(--black);border:none;padding:6px 14px;border-radius:20px;font-weight:700;font-size:.78rem;cursor:pointer;letter-spacing:.5px;transition:.3s}
.mode-toggle:hover{background:#d4b664}

/* PROGRESS */
.progress-bar{position:fixed;top:56px;left:0;width:100%;height:5px;background:rgba(255,255,255,.1);z-index:999}
.progress-fill{height:100%;background:linear-gradient(90deg,var(--crimson),var(--gold));width:0%;transition:width .4s;border-radius:0 3px 3px 0}
.section-indicator{position:fixed;top:68px;right:20px;background:var(--black);color:var(--gold);padding:4px 12px;border-radius:20px;font-size:.75rem;font-weight:700;z-index:998;opacity:.8;transition:.3s}

/* SECTIONS */
.lesson-section{padding:80px 20px;max-width:1100px;margin:0 auto}
.full-section{max-width:100%;padding:80px 0}
.full-section .section-inner{max-width:1100px;margin:0 auto;padding:0 20px}
.section-tag{display:inline-block;background:var(--crimson);color:#fff;padding:4px 14px;border-radius:3px;font-size:.72rem;font-weight:700;text-transform:uppercase;letter-spacing:2px;margin-bottom:10px}
h2.sec-title{font-family:'VTC Du Bois',serif;font-size:clamp(1.7rem,4vw,2.6rem);color:var(--black);margin-bottom:8px;line-height:1.2}
.sec-sub{font-size:1.05rem;color:#666;margin-bottom:36px;max-width:700px}

/* REVEAL */
.reveal{opacity:0;transform:translateY(28px);transition:all .7s ease-out}
.reveal.visible{opacity:1;transform:none}

/* HERO */
.hero{min-height:100vh;display:flex;align-items:center;justify-content:center;text-align:center;background:linear-gradient(135deg,#2a1a0a 0%,#4a3020 40%,#3a2518 70%,var(--black) 100%);position:relative;overflow:hidden;padding:80px 20px 40px}
.hero::before{content:'';position:absolute;inset:0;background:radial-gradient(ellipse at 30% 40%,rgba(197,165,90,.15) 0%,transparent 55%),radial-gradient(ellipse at 70% 60%,rgba(139,26,26,.12) 0%,transparent 55%)}
.hero-content{position:relative;z-index:2;max-width:800px}
.hero-badge{display:inline-block;background:var(--gold);color:var(--black);padding:6px 22px;border-radius:30px;font-size:.82rem;font-weight:700;letter-spacing:2px;text-transform:uppercase;margin-bottom:24px}
.hero h1{font-family:'VTC Du Bois',serif;font-size:clamp(2.5rem,6vw,4.5rem);color:#fff;line-height:1.1;margin-bottom:10px}
.hero h1 span{color:var(--gold)}
.hero h2{font-family:'VTC Du Bois',serif;font-size:clamp(1rem,2.5vw,1.5rem);color:#ccc;font-weight:400;margin-bottom:20px}
.hero-quote{font-family:'VTC Du Bois',serif;font-style:italic;color:var(--gold);font-size:1.05rem;max-width:600px;margin:0 auto 36px}
.hero-cta{display:inline-block;background:var(--crimson);color:#fff;padding:14px 34px;text-decoration:none;font-weight:700;border-radius:6px;transition:.3s;text-transform:uppercase;letter-spacing:1px;font-size:.95rem}
.hero-cta:hover{background:#a52020;transform:translateY(-2px);box-shadow:0 6px 20px rgba(139,26,26,.4)}

/* EXPLORER / SCHOLAR */
.explorer-only{display:none}
.scholar-only{display:none}
body.mode-explorer .explorer-only{display:block}
body.mode-scholar .scholar-only{display:block}

/* CARDS */
.grid-2{display:grid;grid-template-columns:1fr 1fr;gap:24px;margin-top:24px}
.grid-3{display:grid;grid-template-columns:repeat(3,1fr);gap:20px;margin-top:24px}
.card{background:#fff;border-radius:14px;padding:30px;box-shadow:0 4px 20px rgba(0,0,0,.06);transition:.3s}
.card:hover{transform:translateY(-3px);box-shadow:0 8px 30px rgba(0,0,0,.1)}
.card h3{font-family:'VTC Du Bois',serif;font-size:1.25rem;margin-bottom:8px;color:var(--crimson)}
.card p,.card li{font-size:.92rem;color:#555;line-height:1.6}
.card ul{padding-left:18px}
.card li{margin-bottom:6px}
.card-dark{background:var(--black);color:#ddd}
.card-dark h3{color:var(--gold)}
.card-dark p,.card-dark li{color:#bbb}
.card-gold{background:linear-gradient(135deg,#fdf8ef,#f5eed8);border:2px solid var(--gold)}
.card-gold h3{color:var(--brown)}

/* TIMELINE */
.timeline-wrap{overflow-x:auto;padding:30px 0 20px}
.timeline-track{display:flex;align-items:flex-start;position:relative;min-width:850px;padding-bottom:10px}
.timeline-track::before{content:'';position:absolute;top:50px;left:0;right:0;height:4px;background:var(--gold)}
.tl-item{flex:1;text-align:center;position:relative;padding:0 8px;cursor:pointer}
.tl-dot{width:22px;height:22px;border-radius:50%;background:var(--gold);margin:40px auto 12px;position:relative;z-index:2;transition:.3s;border:3px solid var(--tan)}
.tl-item:hover .tl-dot{transform:scale(1.4);background:var(--crimson)}
.tl-item.hl .tl-dot{background:var(--crimson);border-color:var(--crimson);width:30px;height:30px;margin-top:36px}
.tl-year{font-family:'VTC Du Bois',serif;font-size:1.2rem;font-weight:700;color:var(--dark-gold)}
.tl-item.hl .tl-year{color:var(--crimson);font-size:1.4rem}
.tl-desc{font-size:.8rem;color:#888;margin-top:2px}
.tl-popup{display:none;position:absolute;bottom:calc(100% + 16px);left:50%;transform:translateX(-50%);background:#fff;color:var(--black);padding:14px 18px;border-radius:10px;font-size:.85rem;width:220px;box-shadow:0 8px 30px rgba(0,0,0,.2);z-index:10;text-align:left;line-height:1.5}
.tl-popup::after{content:'';position:absolute;top:100%;left:50%;transform:translateX(-50%);border:8px solid transparent;border-top-color:#fff}
.tl-item:hover .tl-popup{display:block}

/* FLIP CARDS */
.flip-card{perspective:800px;height:280px;cursor:pointer}
.flip-inner{position:relative;width:100%;height:100%;transition:transform .6s;transform-style:preserve-3d}
.flip-card:hover .flip-inner,.flip-card.flipped .flip-inner{transform:rotateY(180deg)}
.flip-front,.flip-back{position:absolute;inset:0;backface-visibility:hidden;border-radius:14px;padding:28px;display:flex;flex-direction:column;justify-content:center}
.flip-back{transform:rotateY(180deg)}
.flip-front{background:var(--black);color:#ddd}
.flip-back{background:#fff;border:2px solid var(--dark-green)}
.flip-front h3{color:var(--gold);font-family:'VTC Du Bois',serif;font-size:1.2rem;margin-bottom:8px}
.flip-back h3{color:var(--dark-green);font-family:'VTC Du Bois',serif;font-size:1.1rem;margin-bottom:8px}
.flip-hint{font-size:.75rem;color:#888;margin-top:auto;text-align:center}

/* STATS */
.stat-row{display:flex;gap:20px;justify-content:center;flex-wrap:wrap;margin:24px 0}
.stat-box{text-align:center;padding:24px 20px;background:#fff;border-radius:14px;box-shadow:0 2px 12px rgba(0,0,0,.06);min-width:160px;flex:1}
.stat-num{font-family:'VTC Du Bois',serif;font-size:2.6rem;font-weight:900;color:var(--crimson);line-height:1}
.stat-label{font-size:.82rem;color:#888;margin-top:4px}

/* TABS */
.tab-bar{display:flex;gap:0;margin:28px auto 0;max-width:550px;background:#e0d6c4;border-radius:10px;overflow:hidden}
.tab-btn{flex:1;padding:13px 18px;border:none;background:transparent;font-weight:700;cursor:pointer;font-size:.92rem;font-family:inherit;transition:.3s;color:#888}
.tab-btn.active{background:var(--crimson);color:#fff}
.tab-panel{margin-top:28px;display:none}
.tab-panel.active{display:block}

/* CHALLENGE */
.challenge{background:linear-gradient(135deg,#fdf8ef,#f5eed8);border:2px solid var(--gold);border-radius:14px;padding:28px;margin-top:24px;max-width:520px}
.challenge h4{font-family:'VTC Du Bois',serif;font-size:1.1rem;color:var(--brown);margin-bottom:8px}
.challenge p{margin-bottom:12px;color:#555;font-size:.92rem}
.ch-row{display:flex;gap:10px;align-items:center}
.ch-input{flex:1;padding:10px 14px;border:2px solid #ddd;border-radius:8px;font-size:1rem;font-family:inherit;transition:.3s}
.ch-input:focus{outline:none;border-color:var(--gold)}
.ch-btn{padding:10px 20px;background:var(--crimson);color:#fff;border:none;border-radius:8px;font-weight:700;cursor:pointer;font-size:.88rem;transition:.3s}
.ch-btn:hover{background:#a52020}
.ch-feedback{margin-top:10px;padding:10px 14px;border-radius:8px;font-weight:600;display:none;font-size:.9rem}
.ch-feedback.correct{display:block;background:#e8f5e9;color:#2e7d32}
.ch-feedback.wrong{display:block;background:#fce4ec;color:#c62828}

/* CHART */
.chart-wrap{background:#fff;border-radius:18px;padding:40px 30px;box-shadow:0 6px 30px rgba(0,0,0,.07);margin:30px auto;max-width:1100px}
canvas{width:100%;height:auto;display:block}
.chart-legend{display:flex;flex-wrap:wrap;gap:16px;justify-content:center;margin-top:14px}
.legend-item{display:flex;align-items:center;gap:6px;font-size:.84rem}
.legend-dot{width:14px;height:14px;border-radius:3px;flex-shrink:0}
.chart-notes{display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-top:20px}
.chart-note{padding:16px 20px;border-radius:10px;font-size:.9rem}
.chart-note.then-n{background:rgba(107,66,38,.1);border-left:4px solid var(--brown)}
.chart-note.now-n{background:rgba(26,26,26,.06);border-left:4px solid var(--black)}
.chart-note strong{display:block;font-size:.78rem;text-transform:uppercase;letter-spacing:1px;margin-bottom:4px}

/* GAP CARDS */
.gap-card{border-radius:14px;padding:28px}
.gap-card.closing{background:rgba(232,200,64,.15);border:2px solid var(--yellow)}
.gap-card.widening{background:rgba(196,30,58,.08);border:2px solid var(--red-accent)}
.gap-card h3{font-family:'VTC Du Bois',serif;font-size:1.15rem;margin-bottom:4px}
.gap-card.closing h3{color:var(--dark-gold)}
.gap-card.widening h3{color:var(--red-accent)}
.gap-visual{display:flex;align-items:center;justify-content:space-between;margin-top:14px;gap:10px}
.gap-pt{text-align:center;font-weight:700}
.gap-pt .yr{font-size:.82rem;color:#888}
.gap-pt .val{font-family:'VTC Du Bois',serif;font-size:1.8rem}
.gap-arrow{flex:1;height:4px;position:relative}
.gap-card.closing .gap-arrow{background:var(--yellow)}
.gap-card.widening .gap-arrow{background:var(--red-accent)}
.gap-arrow::after{content:'';position:absolute;right:-6px;top:50%;transform:translateY(-50%);border:6px solid transparent}
.gap-card.closing .gap-arrow::after{border-left-color:var(--yellow)}
.gap-card.widening .gap-arrow::after{border-left-color:var(--red-accent)}

/* TOGGLE VIEW */
.view-toggle{display:flex;gap:0;margin:24px auto 0;max-width:400px;background:#e0d6c4;border-radius:10px;overflow:hidden}
.vt-btn{flex:1;padding:12px;border:none;background:transparent;font-weight:700;cursor:pointer;font-size:.9rem;font-family:inherit;transition:.3s;color:#888}
.vt-btn.active{background:var(--black);color:#fff}
.view-panel{display:none;margin-top:24px}
.view-panel.active{display:block}

/* SENSORY */
.sensory-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:24px;margin-top:24px}
.sensory-card{background:#fff;border-radius:14px;padding:28px;text-align:center;cursor:pointer;transition:.3s;border-bottom:4px solid transparent}
.sensory-card:hover{transform:translateY(-4px);box-shadow:0 8px 24px rgba(0,0,0,.1);border-bottom-color:var(--gold)}
.sensory-icon{font-size:2.5rem;margin-bottom:12px}
.sensory-card h4{font-family:'VTC Du Bois',serif;margin-bottom:6px;font-size:1.1rem}
.sensory-card p{font-size:.88rem;color:#555}
.sensory-detail{display:none;margin-top:12px;padding-top:12px;border-top:1px dashed var(--gold);font-size:.85rem;color:#666;font-style:italic;text-align:left}
.sensory-card.open .sensory-detail{display:block}

/* QUIZ */
.quiz-box{background:var(--black);color:#fff;border-radius:18px;padding:44px 36px;margin:30px auto;max-width:800px}
.quiz-box h2{font-family:'VTC Du Bois',serif;color:#fff;font-size:1.8rem;margin-bottom:6px}
.quiz-box .sec-sub{color:#999}
.q-progress{background:rgba(255,255,255,.1);border-radius:10px;height:8px;margin-bottom:28px;overflow:hidden}
.q-bar{height:100%;background:var(--gold);border-radius:10px;transition:width .5s}
.q-card{display:none;animation:fadeIn .4s}
.q-card.active{display:block}
@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:none}}
.q-text{font-family:'VTC Du Bois',serif;font-size:1.3rem;margin-bottom:20px;line-height:1.4}
.q-opts{display:flex;flex-direction:column;gap:10px}
.q-opt{background:rgba(255,255,255,.08);border:2px solid rgba(255,255,255,.15);border-radius:10px;padding:14px 18px;cursor:pointer;transition:.3s;font-size:.95rem;color:#ddd}
.q-opt:hover{border-color:var(--gold);background:rgba(197,165,90,.1)}
.q-opt.correct{border-color:#4caf50;background:rgba(76,175,80,.2);color:#81c784}
.q-opt.wrong{border-color:#f44336;background:rgba(244,67,54,.2);color:#ef9a9a}
.q-fb{margin-top:14px;padding:14px 18px;border-radius:10px;display:none;font-size:.9rem;line-height:1.5}
.q-fb.show{display:block}
.q-fb.ok{background:rgba(76,175,80,.15);color:#81c784}
.q-fb.no{background:rgba(244,67,54,.15);color:#ef9a9a}
.q-next{margin-top:18px;padding:11px 26px;background:var(--gold);color:var(--black);border:none;border-radius:8px;font-weight:700;cursor:pointer;font-size:.9rem;display:none}
.q-next:hover{background:#d4b664}
.q-score{text-align:center;display:none}
.q-score h3{font-family:'VTC Du Bois',serif;font-size:2rem;color:var(--gold);margin-bottom:8px}
.q-score p{color:#bbb;font-size:1.05rem}
.q-restart{margin-top:16px;padding:11px 26px;background:var(--crimson);color:#fff;border:none;border-radius:8px;font-weight:700;cursor:pointer;font-size:.9rem}

/* VOCAB */
.vocab-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:18px;margin-top:24px}
.vocab-card{background:#fff;border-radius:12px;padding:22px;cursor:pointer;transition:.3s;border-bottom:4px solid transparent}
.vocab-card:hover{transform:translateY(-3px);box-shadow:0 6px 20px rgba(0,0,0,.08);border-bottom-color:var(--crimson)}
.vocab-card h4{font-family:'VTC Du Bois',serif;color:var(--crimson);margin-bottom:6px;font-size:1rem}
.vocab-card p{font-size:.85rem;color:#555}

/* PROMPT CARDS */
.prompt-card{border:3px solid var(--crimson);border-radius:14px;padding:28px;background:#fff;transition:.3s}
.prompt-card:hover{box-shadow:0 8px 30px rgba(139,26,26,.12);transform:translateY(-2px)}
.prompt-card h3{font-family:'VTC Du Bois',serif;color:var(--crimson);margin-bottom:10px;font-size:1.15rem}
.prompt-card p{font-size:.9rem;color:#555;line-height:1.6;margin-bottom:14px}
.prompt-card textarea{width:100%;height:120px;border:2px solid #ddd;border-radius:8px;padding:12px;font-family:inherit;font-size:.9rem;resize:vertical;transition:.3s}
.prompt-card textarea:focus{outline:none;border-color:var(--gold)}

/* FLASHCARD */
.fc-container{max-width:400px;margin:20px auto;text-align:center}
.fc-card{background:#fff;border-radius:14px;padding:40px 30px;min-height:200px;box-shadow:0 4px 20px rgba(0,0,0,.08);cursor:pointer;transition:.3s;display:flex;flex-direction:column;align-items:center;justify-content:center}
.fc-card:hover{box-shadow:0 8px 30px rgba(0,0,0,.12)}
.fc-term{font-family:'VTC Du Bois',serif;font-size:1.5rem;color:var(--crimson)}
.fc-def{font-size:1rem;color:#555;margin-top:12px;display:none}
.fc-card.show-def .fc-def{display:block}
.fc-card.show-def .fc-term{font-size:1.1rem;margin-bottom:4px}
.fc-nav{margin-top:12px;display:flex;gap:12px;justify-content:center}
.fc-nav button{padding:8px 20px;border:2px solid var(--gold);background:transparent;border-radius:8px;font-weight:700;cursor:pointer;font-size:.85rem;transition:.3s}
.fc-nav button:hover{background:var(--gold);color:var(--black)}

/* CLOSING */
.closing{text-align:center;padding:90px 20px;background:linear-gradient(135deg,var(--black) 0%,#2c1810 100%);color:#fff;max-width:100%}
.closing blockquote{font-family:'VTC Du Bois',serif;font-size:clamp(1.3rem,3.5vw,2.1rem);font-weight:700;max-width:750px;margin:0 auto 18px;line-height:1.4}
.closing cite{font-style:normal;color:var(--gold);font-size:1.05rem}
.closing-links{margin-top:30px;display:flex;gap:16px;justify-content:center;flex-wrap:wrap}
.closing-link{display:inline-block;padding:12px 28px;border-radius:8px;text-decoration:none;font-weight:700;font-size:.9rem;transition:.3s}
.cl-hub{background:var(--gold);color:var(--black)}
.cl-hub:hover{background:#d4b664}
.cl-l1{border:2px solid var(--gold);color:var(--gold)}
.cl-l1:hover{background:var(--gold);color:var(--black)}

footer{background:var(--black);color:#888;text-align:center;padding:28px 20px;font-size:.82rem}
footer strong{color:var(--gold)}

/* SOUND TOGGLE */
.sound-toggle{position:fixed;bottom:20px;right:20px;z-index:1001;width:48px;height:48px;border-radius:50%;background:var(--black);border:2px solid var(--gold);color:var(--gold);font-size:1.4rem;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:.3s;box-shadow:0 4px 15px rgba(0,0,0,.3)}
.sound-toggle:hover{background:#2a2a2a;transform:scale(1.1)}

/* ACHIEVEMENT BADGE SYSTEM */
.badge-toggle{position:fixed;bottom:20px;left:20px;z-index:1001;width:48px;height:48px;border-radius:50%;background:var(--black);border:2px solid var(--gold);color:var(--gold);font-size:1.4rem;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:.3s;box-shadow:0 4px 15px rgba(0,0,0,.3)}
.badge-toggle:hover{background:#2a2a2a;transform:scale(1.1)}
.badge-drawer{position:fixed;bottom:80px;left:20px;z-index:1000;background:var(--black);border:2px solid var(--gold);border-radius:14px;padding:20px;width:280px;max-height:70vh;overflow-y:auto;transform:translateY(20px);opacity:0;pointer-events:none;transition:.3s;box-shadow:0 8px 30px rgba(0,0,0,.4)}
.badge-drawer.open{transform:translateY(0);opacity:1;pointer-events:auto}
.badge-drawer h3{font-family:'VTC Du Bois',serif;color:var(--gold);font-size:1.1rem;margin-bottom:12px}
.badge-item{display:flex;align-items:center;gap:10px;padding:8px;border-radius:8px;margin-bottom:6px;background:rgba(255,255,255,.05);transition:.3s}
.badge-item.earned{background:rgba(197,165,90,.15);border:1px solid var(--gold)}
.badge-item.locked{opacity:.4;filter:grayscale(1)}
.badge-icon{font-size:1.5rem;flex-shrink:0}
.badge-info h4{font-size:.85rem;color:#ddd;margin:0}
.badge-info p{font-size:.72rem;color:#888;margin:0}
.badge-toast{position:fixed;bottom:80px;left:50%;transform:translateX(-50%) translateY(20px);z-index:1002;background:var(--black);border:2px solid var(--gold);color:#fff;padding:14px 24px;border-radius:12px;font-size:.9rem;opacity:0;transition:.4s;pointer-events:none;white-space:nowrap;box-shadow:0 8px 30px rgba(0,0,0,.4)}
.badge-toast.show{opacity:1;transform:translateX(-50%) translateY(0)}

/* DRAG AND DROP */
.dnd-activity{background:linear-gradient(135deg,#fdf8ef,#f5eed8);border:2px solid var(--gold);border-radius:14px;padding:28px;margin-top:24px}
.dnd-activity h4{font-family:'VTC Du Bois',serif;font-size:1.15rem;color:var(--brown);margin-bottom:6px}
.dnd-activity>p{font-size:.92rem;color:#555;margin-bottom:16px}
.dnd-items{display:flex;flex-wrap:wrap;gap:10px;margin-bottom:20px;min-height:44px}
.dnd-chip{padding:10px 16px;background:var(--black);color:#ddd;border-radius:8px;cursor:grab;font-size:.88rem;font-weight:600;transition:.3s;user-select:none}
.dnd-chip:active{cursor:grabbing;transform:scale(1.05)}
.dnd-chip.placed{opacity:.4;pointer-events:none}
.dnd-targets{display:grid;grid-template-columns:1fr 1fr;gap:16px}
.dnd-zone{min-height:120px;border:3px dashed #ccc;border-radius:12px;padding:14px;transition:.3s}
.dnd-zone.over{background:rgba(197,165,90,.1)}
.dnd-zone.zone-close{border-color:var(--yellow)}
.dnd-zone.zone-widen{border-color:var(--red-accent)}
.dnd-zone h5{font-family:'VTC Du Bois',serif;font-size:1rem;margin-bottom:8px;text-align:center}
.dnd-zone.zone-close h5{color:var(--dark-gold)}
.dnd-zone.zone-widen h5{color:var(--red-accent)}
.dnd-dropped{padding:8px 12px;border-radius:6px;font-size:.85rem;font-weight:600;margin-bottom:6px;animation:fadeIn .3s}
.dnd-dropped.correct{background:#e8f5e9;color:#2e7d32}
.dnd-dropped.wrong{background:#fce4ec;color:#c62828;animation:shake .4s}
@keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-8px)}75%{transform:translateX(8px)}}
.dnd-complete{text-align:center;padding:14px;background:#e8f5e9;border-radius:10px;margin-top:14px;font-weight:700;color:#2e7d32;display:none}

/* TYPEWRITER */
.typewriter-text{display:inline}
.typewriter-cursor{display:inline-block;width:2px;height:1em;background:var(--gold);margin-left:2px;animation:blink .7s infinite}
@keyframes blink{0%,100%{opacity:1}50%{opacity:0}}

/* CERTIFICATE */
.cert-btn{margin-top:16px;padding:11px 26px;background:var(--gold);color:var(--black);border:none;border-radius:8px;font-weight:700;cursor:pointer;font-size:.9rem;transition:.3s}
.cert-btn:hover{background:#d4b664;transform:translateY(-1px)}
.cert-overlay{position:fixed;inset:0;z-index:2000;background:rgba(0,0,0,.7);display:none;align-items:center;justify-content:center;padding:20px}
.cert-overlay.open{display:flex}
.cert-modal{background:var(--parchment);border:6px double var(--gold);border-radius:18px;padding:48px 40px;max-width:600px;width:100%;text-align:center;position:relative;box-shadow:0 20px 60px rgba(0,0,0,.4)}
.cert-modal h2{font-family:'VTC Du Bois',serif;font-size:2rem;color:var(--crimson);margin-bottom:4px}
.cert-modal h3{font-family:'VTC Du Bois',serif;font-size:1.1rem;color:var(--brown);margin-bottom:20px;font-weight:400}
.cert-modal .cert-name{font-family:'VTC Du Bois',serif;font-size:1.8rem;color:var(--black);margin:16px 0;padding-bottom:8px;border-bottom:2px solid var(--gold);display:inline-block;min-width:200px}
.cert-modal .cert-details{font-size:.9rem;color:#666;line-height:1.8;margin:16px 0}
.cert-modal .cert-details strong{color:var(--crimson)}
.cert-input{padding:12px 18px;border:2px solid var(--gold);border-radius:8px;font-family:'VTC Du Bois',serif;font-size:1.1rem;text-align:center;width:80%;margin-bottom:16px}
.cert-input:focus{outline:none;border-color:var(--crimson)}
.cert-actions{display:flex;gap:12px;justify-content:center;margin-top:16px}
.cert-actions button{padding:10px 24px;border-radius:8px;font-weight:700;cursor:pointer;font-size:.88rem;border:none;transition:.3s}
.cert-print{background:var(--crimson);color:#fff}
.cert-print:hover{background:#a52020}
.cert-close{background:transparent;border:2px solid #999 !important;color:#666}
.cert-close:hover{background:#eee}

/* PARALLAX DIVIDERS */
.parallax-divider{height:100px;position:relative;overflow:hidden;display:flex;align-items:center;justify-content:center}
.parallax-svg{position:absolute;inset:0;opacity:.1}
.parallax-svg svg{width:100%;height:100%}
.parallax-line{width:60%;height:2px;background:linear-gradient(90deg,transparent,var(--gold),transparent);z-index:1}

/* SVG BORDER ART */
.svg-border-art{position:absolute;pointer-events:none;z-index:2}
.svg-border-art line,.svg-border-art circle{stroke:var(--gold);fill:none;stroke-width:2;stroke-dasharray:200;stroke-dashoffset:200;transition:stroke-dashoffset 2s ease-out}
.svg-border-art.animated line,.svg-border-art.animated circle{stroke-dashoffset:0}
.svg-border-target{position:relative}

@media print{
  .sound-toggle,.badge-toggle,.badge-drawer,.badge-toast,nav,.progress-bar,.section-indicator,.cert-actions,.cert-close{display:none !important}
  .cert-overlay{position:static !important;background:none !important}
  .cert-modal{box-shadow:none !important;border:4px double var(--gold) !important;max-width:100% !important}
  body{background:#fff !important}
}

@media(max-width:800px){
  .grid-2,.chart-notes,.sensory-grid,.dnd-targets{grid-template-columns:1fr}
  .grid-3,.vocab-grid{grid-template-columns:1fr 1fr}
  .stat-row{flex-direction:column;align-items:center}
  .chart-wrap,.quiz-box{padding:28px 18px;margin:20px 10px}
  .badge-drawer{left:10px;width:calc(100vw - 80px)}
  .cert-modal{padding:28px 20px}
}
@media(max-width:550px){
  .grid-3,.vocab-grid{grid-template-columns:1fr}
  .lesson-section{padding:50px 14px}
}
</style>
</head>
<body>

<!-- NAV -->
<nav>
  <div class="nav-inner">
    <a href="index.html" class="nav-brand">Du Bois Does Data</a>
    <div class="nav-right">
      <a href="index.html" class="nav-home">Hub</a>
      <a href="lesson1-detective.html" class="nav-home">Lesson 1</a>
      <button class="mode-toggle" id="modeBtn" onclick="toggleMode()">Explorer</button>
    </div>
  </div>
</nav>
<div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
<div class="section-indicator" id="secIndicator">Section 1 of 9</div>

<!-- HERO -->
<section class="hero" data-sec="0">
  <div class="hero-content">
    <div class="hero-badge">Lesson 2 &bull; 60&ndash;90 Minutes</div>
    <h1><span>Du Bois</span> Does Data</h1>
    <h2>Seeing the Story of the Color Line</h2>
    <p class="hero-quote" id="heroQuote" data-typewriter="&quot;The problem of the twentieth century is the problem of the color line.&quot; â€” W.E.B. Du Bois"></p>
    <a href="#sec1" class="hero-cta">Begin the Analysis</a>
  </div>
</section>

<!-- SECTION 1: THE PROBLEM OF THE COLOR LINE -->
<section class="lesson-section reveal" id="sec1" data-sec="1">
  <span class="section-tag">Section 1 of 9</span>
  <h2 class="sec-title">The Problem of the 20th Century Was the Problem of the Color Line</h2>
  <p class="sec-sub">In 1900, the world came together in Paris. But for Black Americans, the story being told about them was built on lies.</p>

  <div class="grid-2">
    <div class="card">
      <h3>The Global Stage &amp; The Context</h3>
      <p><strong>The year is 1900.</strong> A massive World's Fair opens in Paris, France. 50 million visitors from around the globe come to see the latest innovations and achievements of nations.</p>
      <p style="margin-top:10px;">The United States wants to showcase its "progress." But it has been only <strong>35 years since slavery ended.</strong> Jim Crow laws are spreading across the American South, enforcing racial segregation.</p>
      <p style="margin-top:10px;">W.E.B. Du Bois is tasked with creating the <strong>"Exhibit of American Negroes"</strong> &mdash; his challenge is to counter the racist narrative on a global stage.</p>
    </div>
    <div class="card-dark card">
      <h3>The Dominant Narrative</h3>
      <p>"Scientific racism" was a <strong>mainstream belief</strong> in 1900. Pseudosciences like phrenology (measuring skull shapes) and eugenics (selective breeding theory) were used to argue for the biological inferiority of Black people.</p>
      <p style="margin-top:10px;">This was not fringe thinking &mdash; it was published in academic journals, taught in universities, and used to <strong>justify discrimination, segregation, and violence.</strong></p>
      <div class="scholar-only" style="margin-top:14px;padding:14px;background:rgba(197,165,90,.1);border-radius:8px;">
        <p style="color:#ccc;font-size:.88rem;"><strong style="color:var(--gold);">Scholar Analysis:</strong> "Scientific racism" functioned as an ideology &mdash; it dressed up prejudice in the language of science to make oppression seem natural and inevitable. By giving racism a "scientific" veneer, it made it harder to challenge. How does understanding this help you recognize similar tactics today?</p>
      </div>
    </div>
  </div>

  <div class="explorer-only" style="margin-top:20px;background:rgba(197,165,90,.15);border-radius:12px;padding:20px;text-align:center;">
    <p style="font-size:.95rem;color:var(--brown);"><strong>Fun Fact:</strong> The 1900 Paris World's Fair featured the debut of escalators, talking films, and diesel engines. It was the Olympics year too! Du Bois's data exhibit competed for attention with ALL of this &mdash; and still made a lasting impact.</p>
  </div>

  <!-- Timeline -->
  <h3 style="font-family:'VTC Du Bois',serif;margin-top:36px;margin-bottom:4px;font-size:1.2rem;">Historical Timeline</h3>
  <p style="color:#888;font-size:.9rem;margin-bottom:10px;">Hover over each event to learn more.</p>
  <div class="timeline-wrap">
    <div class="timeline-track">
      <div class="tl-item"><div class="tl-year">1863</div><div class="tl-dot"></div><div class="tl-desc">Emancipation Proclamation</div><div class="tl-popup">President Lincoln declared enslaved people in Confederate states free. A wartime measure, not yet full abolition.</div></div>
      <div class="tl-item"><div class="tl-year">1865</div><div class="tl-dot"></div><div class="tl-desc">Slavery Ends</div><div class="tl-popup">The 13th Amendment formally abolished slavery. Nearly 4 million people freed after 246 years of bondage.</div></div>
      <div class="tl-item"><div class="tl-year">1868</div><div class="tl-dot"></div><div class="tl-desc">Du Bois Born</div><div class="tl-popup">Born in Great Barrington, Massachusetts &mdash; just 3 years after slavery ended. Would become the first Black American to earn a Ph.D. from Harvard.</div></div>
      <div class="tl-item"><div class="tl-year">1896</div><div class="tl-dot"></div><div class="tl-desc">Plessy v. Ferguson</div><div class="tl-popup">Supreme Court ruled "separate but equal" was constitutional, legalizing segregation and giving legal cover to Jim Crow for decades.</div></div>
      <div class="tl-item hl"><div class="tl-year">1900</div><div class="tl-dot"></div><div class="tl-desc">Paris Exhibition</div><div class="tl-popup"><strong>THIS IS OUR FOCUS.</strong> Du Bois presents 63 hand-drawn data visualizations at the Paris World's Fair to counter racist narratives with evidence.</div></div>
      <div class="tl-item"><div class="tl-year">1909</div><div class="tl-dot"></div><div class="tl-desc">NAACP Founded</div><div class="tl-popup">Du Bois co-founded the NAACP, which became the most influential civil rights organization in American history.</div></div>
      <div class="tl-item"><div class="tl-year">1963</div><div class="tl-dot"></div><div class="tl-desc">Du Bois Dies</div><div class="tl-popup">Du Bois died August 27, 1963 &mdash; the day before the March on Washington where MLK gave "I Have a Dream." His life spanned nearly a century of struggle.</div></div>
    </div>
  </div>
</section>

<div class="parallax-divider" data-parallax><div class="parallax-svg"><svg viewBox="0 0 400 100"><circle cx="200" cy="50" r="45" fill="none" stroke="var(--gold)" stroke-width="1"/><circle cx="200" cy="50" r="35" fill="none" stroke="var(--gold)" stroke-width="1"/><circle cx="200" cy="50" r="25" fill="none" stroke="var(--gold)" stroke-width="1"/><circle cx="200" cy="50" r="15" fill="none" stroke="var(--gold)" stroke-width="1"/></svg></div><div class="parallax-line"></div></div>

<!-- SECTION 2: DU BOIS'S RADICAL IDEA -->
<section class="lesson-section reveal" id="sec2" data-sec="2">
  <span class="section-tag">Section 2 of 9</span>
  <h2 class="sec-title">Du Bois's Radical Idea: To Fight Lies with Facts</h2>
  <p class="sec-sub">Instead of relying on essays or moral arguments alone, Du Bois and his students at Atlanta University took a scientific approach.</p>

  <div class="stat-row svg-border-target" id="statRowBorder">
    <div class="stat-box"><div class="stat-num">63</div><div class="stat-label">Hand-drawn Charts</div></div>
    <div class="stat-box"><div class="stat-num">1900</div><div class="stat-label">Paris Exhibition</div></div>
    <div class="stat-box"><div class="stat-num">50M</div><div class="stat-label">Fair Visitors</div></div>
    <svg class="svg-border-art" style="position:absolute;top:-8px;left:-8px;width:50px;height:50px;"><line x1="0" y1="25" x2="0" y2="0"/><line x1="0" y1="0" x2="25" y2="0"/><circle cx="0" cy="0" r="4"/></svg>
    <svg class="svg-border-art" style="position:absolute;top:-8px;right:-8px;width:50px;height:50px;"><line x1="50" y1="25" x2="50" y2="0"/><line x1="50" y1="0" x2="25" y2="0"/><circle cx="50" cy="0" r="4"/></svg>
    <svg class="svg-border-art" style="position:absolute;bottom:-8px;left:-8px;width:50px;height:50px;"><line x1="0" y1="25" x2="0" y2="50"/><line x1="0" y1="50" x2="25" y2="50"/><circle cx="0" cy="50" r="4"/></svg>
    <svg class="svg-border-art" style="position:absolute;bottom:-8px;right:-8px;width:50px;height:50px;"><line x1="50" y1="25" x2="50" y2="50"/><line x1="50" y1="50" x2="25" y2="50"/><circle cx="50" cy="50" r="4"/></svg>
  </div>

  <p style="text-align:center;max-width:700px;margin:10px auto 30px;color:#666;">They created <strong>63 hand-drawn charts, graphs, and maps</strong> using rigorous, empirical data. Their goal: to use real numbers to prove the progress and capability of Black Americans since Emancipation.</p>

  <h3 style="font-family:'VTC Du Bois',serif;text-align:center;margin-bottom:16px;">Click to compare: Pseudoscience vs. Real Science</h3>
  <div class="grid-2">
    <div class="flip-card" onclick="this.classList.toggle('flipped');sfxClick();flipCardsFlipped.add('pseudo');if(flipCardsFlipped.size>=2)awardBadge('myth-buster');">
      <div class="flip-inner">
        <div class="flip-front">
          <h3>Racist Pseudoscience</h3>
          <p>Claims dressed up as "science" to justify oppression. What did they actually say?</p>
          <div class="flip-hint">Click to reveal</div>
        </div>
        <div class="flip-back">
          <h3 style="color:var(--red-accent);">The Lies</h3>
          <ul style="padding-left:16px;font-size:.88rem;color:#555;">
            <li>Phrenology: measured skulls to "prove" inferior intelligence</li>
            <li>Eugenics: claimed racial hierarchy was biological</li>
            <li>No real evidence &mdash; just prejudice in scientific clothing</li>
            <li><strong>Purpose:</strong> To justify discrimination &amp; segregation</li>
          </ul>
        </div>
      </div>
    </div>
    <div class="flip-card" onclick="this.classList.toggle('flipped');sfxClick();flipCardsFlipped.add('dubois');if(flipCardsFlipped.size>=2)awardBadge('myth-buster');">
      <div class="flip-inner">
        <div class="flip-front" style="background:var(--dark-green);">
          <h3 style="color:#fff;">Du Bois's Data Science</h3>
          <p>Real data, beautiful charts, undeniable evidence. What did he show?</p>
          <div class="flip-hint" style="color:rgba(255,255,255,.5);">Click to reveal</div>
        </div>
        <div class="flip-back" style="border-color:var(--dark-green);">
          <h3 style="color:var(--dark-green);">The Truth</h3>
          <ul style="padding-left:16px;font-size:.88rem;color:#555;">
            <li>Used real census data, surveys, and sociological research</li>
            <li>Created 63 stunning, hand-drawn visualizations</li>
            <li>"Strikingly vibrant and modern" &mdash; anticipating Mondrian &amp; Kandinsky</li>
            <li><strong>Purpose:</strong> To prove capability &amp; demand equality</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <p style="text-align:center;font-family:'VTC Du Bois',serif;font-size:1.4rem;font-weight:700;margin-top:30px;">Du Bois's weapon wasn't a sword &mdash; <span style="color:var(--crimson);">it was data.</span></p>

  <div class="scholar-only" style="margin-top:24px;background:#fff;border-radius:12px;padding:24px;border-left:4px solid var(--crimson);">
    <h4 style="font-family:'VTC Du Bois',serif;color:var(--crimson);margin-bottom:8px;">Scholar Reflection</h4>
    <p style="font-size:.92rem;color:#555;">Why was a data-based approach "radical" in 1900? How is using data different from moral arguments or emotional appeals? Consider: Du Bois was operating in a context where the opposition ALSO claimed "science" was on their side. What made his approach different?</p>
    <textarea style="width:100%;height:80px;margin-top:10px;border:2px solid #ddd;border-radius:8px;padding:10px;font-family:inherit;font-size:.9rem;resize:vertical;" placeholder="Write your analysis here..."></textarea>
  </div>
</section>

<div class="parallax-divider" data-parallax><div class="parallax-svg"><svg viewBox="0 0 400 100"><line x1="200" y1="50" x2="200" y2="5" stroke="var(--gold)" stroke-width="1"/><line x1="200" y1="50" x2="350" y2="15" stroke="var(--gold)" stroke-width="1"/><line x1="200" y1="50" x2="350" y2="85" stroke="var(--gold)" stroke-width="1"/><line x1="200" y1="50" x2="200" y2="95" stroke="var(--gold)" stroke-width="1"/><line x1="200" y1="50" x2="50" y2="85" stroke="var(--gold)" stroke-width="1"/><line x1="200" y1="50" x2="50" y2="15" stroke="var(--gold)" stroke-width="1"/></svg></div><div class="parallax-line"></div></div>

<!-- SECTION 3: THEN (1900) - SOUTHERN POPULATION -->
<section class="lesson-section reveal" id="sec3" data-sec="3">
  <span class="section-tag">Section 3 of 9</span>
  <h2 class="sec-title">Then (1900): A Southern Population, Rooted by Slavery's Legacy</h2>
  <p class="sec-sub">Du Bois's data revealed a stark geographic reality. The legacy of slavery was written on the map.</p>

  <div class="stat-row">
    <div class="stat-box"><div class="stat-num" style="font-size:3.5rem;">90%</div><div class="stat-label">of all Black Americans lived in the South</div></div>
    <div class="stat-box"><div class="stat-num">8.8M</div><div class="stat-label">Total Population</div></div>
    <div class="stat-box"><div class="stat-num">35</div><div class="stat-label">Years Since Slavery</div></div>
  </div>

  <div style="margin:30px auto;max-width:750px;">
    <canvas id="mapCanvas" width="750" height="460"></canvas>
  </div>

  <div class="grid-2" style="margin-top:20px;">
    <div class="card">
      <h3>What the Map Shows</h3>
      <p>In 1900, <strong>9 out of 10 Black Americans</strong> lived in the South, concentrated in the former slave states. The states with the highest populations were Mississippi, Georgia, Alabama, South Carolina, Louisiana, and Texas.</p>
      <p style="margin-top:8px;">This was <strong>not coincidence</strong> &mdash; it was direct evidence of how the geography of slavery continued to shape and constrain Black life, 35 years after Emancipation.</p>
    </div>
    <div class="card-gold card">
      <h3>Why This Matters</h3>
      <p>Du Bois used this data to show that Black Americans were <strong>rooted in the South</strong> not by choice but by the legacy of an institution that had lasted 246 years.</p>
      <p style="margin-top:8px;">The South in 1900 was also where Jim Crow laws were strongest &mdash; meaning the vast majority of Black Americans lived under legalized segregation and discrimination.</p>
      <div class="explorer-only" style="margin-top:10px;padding:10px;background:rgba(197,165,90,.2);border-radius:8px;">
        <p style="font-size:.85rem;color:var(--brown);"><strong>Did You Know?</strong> In 1900, Mississippi's population was 59% Black &mdash; a majority! Yet Black citizens were almost entirely denied the right to vote.</p>
      </div>
    </div>
  </div>

  <div class="scholar-only" style="margin-top:20px;background:#fff;border-radius:12px;padding:24px;border-left:4px solid var(--crimson);">
    <h4 style="font-family:'VTC Du Bois',serif;color:var(--crimson);margin-bottom:8px;">Scholar Analysis</h4>
    <p style="font-size:.92rem;color:#555;">How did slavery's geography become Jim Crow's geography? Why did Black Americans remain concentrated in the South even after slavery ended? Consider economic factors (sharecropping), legal barriers (Black Codes), and social forces (family ties, community).</p>
    <textarea style="width:100%;height:80px;margin-top:10px;border:2px solid #ddd;border-radius:8px;padding:10px;font-family:inherit;font-size:.9rem;resize:vertical;" placeholder="Write your analysis here..."></textarea>
  </div>
</section>

<div class="parallax-divider" data-parallax><div class="parallax-svg"><svg viewBox="0 0 400 100"><polygon points="200,10 240,35 240,65 200,90 160,65 160,35" fill="none" stroke="var(--gold)" stroke-width="1"/><polygon points="200,20 230,38 230,62 200,80 170,62 170,38" fill="none" stroke="var(--gold)" stroke-width="1"/><polygon points="200,30 220,42 220,58 200,70 180,58 180,42" fill="none" stroke="var(--gold)" stroke-width="1"/></svg></div><div class="parallax-line"></div></div>

<!-- SECTION 4: NOW (2020) - NATIONAL PRESENCE -->
<section class="lesson-section reveal" id="sec4" data-sec="4">
  <span class="section-tag">Section 4 of 9</span>
  <h2 class="sec-title">Now (2020): A National Presence Forged by Migration</h2>
  <p class="sec-sub">What happened between 1900 and today was one of the greatest population movements in American history.</p>

  <div class="tab-bar">
    <button class="tab-btn active" onclick="showTab('then4',this)">1900: Then</button>
    <button class="tab-btn" onclick="showTab('mig4',this)">The Great Migration</button>
    <button class="tab-btn" onclick="showTab('now4',this)">2020: Now</button>
  </div>

  <div class="tab-panel active" id="panel-then4">
    <div class="stat-row">
      <div class="stat-box"><div class="stat-num">90%</div><div class="stat-label">Lived in the South</div></div>
      <div class="stat-box"><div class="stat-num">8.8M</div><div class="stat-label">Total Population</div></div>
    </div>
    <p style="text-align:center;color:#666;max-width:600px;margin:12px auto;">In Du Bois's time, the geography of slavery still defined where Black Americans lived. The South held nearly the entire population.</p>
  </div>

  <div class="tab-panel" id="panel-mig4">
    <div class="stat-row">
      <div class="stat-box"><div class="stat-num">6M+</div><div class="stat-label">People Moved (1916&ndash;1970)</div></div>
      <div class="stat-box"><div class="stat-num">54</div><div class="stat-label">Years of Migration</div></div>
    </div>
    <p style="text-align:center;color:#666;max-width:650px;margin:12px auto;">From 1916 to 1970, over <strong>6 million people</strong> moved from the South to Northern and Western cities &mdash; escaping Jim Crow laws and seeking better jobs. They built thriving communities in Chicago, Detroit, New York, Philadelphia, Los Angeles, Seattle, San Francisco, and Denver.</p>
    <div class="explorer-only" style="margin-top:16px;text-align:center;">
      <p style="font-size:.88rem;color:var(--brown);background:rgba(197,165,90,.15);display:inline-block;padding:8px 16px;border-radius:8px;"><strong>Push Factors:</strong> Jim Crow, violence, sharecropping &nbsp;|&nbsp; <strong>Pull Factors:</strong> Factory jobs, voting rights, freedom</p>
    </div>
    <div class="scholar-only" style="margin-top:16px;background:#fff;border-radius:12px;padding:20px;border-left:4px solid var(--crimson);">
      <h4 style="font-family:'VTC Du Bois',serif;color:var(--crimson);margin-bottom:6px;">Scholar: Push vs. Pull</h4>
      <p style="font-size:.88rem;color:#555;">Historians debate whether the Great Migration was primarily driven by "push factors" (fleeing Jim Crow, racial violence, crop failures) or "pull factors" (industrial jobs, higher wages, greater freedom). What does this framing reveal about agency and choice?</p>
    </div>
  </div>

  <div class="tab-panel" id="panel-now4">
    <div class="stat-row">
      <div class="stat-box"><div class="stat-num">58%</div><div class="stat-label">South</div></div>
      <div class="stat-box"><div class="stat-num">32%</div><div class="stat-label">North</div></div>
      <div class="stat-box"><div class="stat-num">10%</div><div class="stat-label">West</div></div>
    </div>
    <p style="text-align:center;color:#666;max-width:650px;margin:12px auto;">Today, the population is more distributed, though a <strong>"Reverse Migration"</strong> has brought many people back to growing Southern cities like Atlanta, Houston, and Charlotte. The South's share dropped from 90% to 58%.</p>

    <div class="challenge" style="margin:20px auto;">
      <h4>Calculation Challenge</h4>
      <p>In 2020, there were 41.1 million Black Americans. If 58% live in the South, how many is that?</p>
      <p style="font-size:.85rem;color:#888;">Hint: 41.1 &times; 0.58 = ?</p>
      <div class="ch-row">
        <input type="number" class="ch-input" id="migCalc" placeholder="Millions..." step="0.1">
        <button class="ch-btn" onclick="checkAnswer('migCalc',23.8,0.5,'migFb')">Check</button>
      </div>
      <div id="migFb" class="ch-feedback"></div>
    </div>
  </div>
</section>

<div class="parallax-divider" data-parallax><div class="parallax-svg"><svg viewBox="0 0 400 100"><path d="M200,10 Q220,25 210,50 Q200,75 220,90" fill="none" stroke="var(--gold)" stroke-width="1"/><path d="M190,10 Q170,30 185,50 Q200,70 180,90" fill="none" stroke="var(--gold)" stroke-width="1"/><path d="M210,10 Q240,30 220,55 Q200,80 230,95" fill="none" stroke="var(--gold)" stroke-width="1"/></svg></div><div class="parallax-line"></div></div>

<!-- SECTION 5: EDUCATION GAPS -->
<section class="lesson-section reveal" id="sec5" data-sec="5">
  <span class="section-tag">Section 5 of 9</span>
  <h2 class="sec-title">A Tale of Two Gaps: The High School Gap is Closing, But the College Gap is Widening</h2>
  <p class="sec-sub">The data reveals a complex story. One gap is narrowing while another grows wider. Understanding why is key.</p>

  <div class="grid-2">
    <div class="gap-card closing">
      <h3>High School Gap: Closing</h3>
      <p style="font-size:.88rem;color:#666;">Free public K-12 education is available to all.</p>
      <div class="gap-visual">
        <div class="gap-pt"><div class="yr">1940</div><div class="val">16.9<span style="font-size:.7rem;">pts</span></div></div>
        <div class="gap-arrow"></div>
        <div class="gap-pt"><div class="yr">2020</div><div class="val" style="color:var(--dark-green);">4.2<span style="font-size:.7rem;">pts</span></div></div>
      </div>
      <p style="font-size:.85rem;color:#777;margin-top:12px;">The gap between Black and White high school completion rates shrank from nearly 17 points to just over 4 points.</p>
    </div>
    <div class="gap-card widening">
      <h3>College Degree Gap: Widening</h3>
      <p style="font-size:.88rem;color:#666;">College comes with major financial barriers.</p>
      <div class="gap-visual">
        <div class="gap-pt"><div class="yr">1940</div><div class="val">3.6<span style="font-size:.7rem;">pts</span></div></div>
        <div class="gap-arrow"></div>
        <div class="gap-pt"><div class="yr">2020</div><div class="val" style="color:var(--red-accent);">12.5<span style="font-size:.7rem;">pts</span></div></div>
      </div>
      <p style="font-size:.85rem;color:#777;margin-top:12px;">The bachelor's degree gap has more than tripled, from 3.6 points to 12.5 points.</p>
    </div>
  </div>

  <div class="chart-wrap svg-border-target" id="gapChartBorder" style="margin-top:30px;">
    <h3 style="font-family:'VTC Du Bois',serif;text-align:center;margin-bottom:16px;">Education Gap Comparison (1940&ndash;2020)</h3>
    <canvas id="gapChart" width="700" height="400"></canvas>
    <svg class="svg-border-art" style="position:absolute;top:-8px;left:-8px;width:50px;height:50px;"><line x1="0" y1="25" x2="0" y2="0"/><line x1="0" y1="0" x2="25" y2="0"/><circle cx="0" cy="0" r="4"/></svg>
    <svg class="svg-border-art" style="position:absolute;top:-8px;right:-8px;width:50px;height:50px;"><line x1="50" y1="25" x2="50" y2="0"/><line x1="50" y1="0" x2="25" y2="0"/><circle cx="50" cy="0" r="4"/></svg>
    <svg class="svg-border-art" style="position:absolute;bottom:-8px;left:-8px;width:50px;height:50px;"><line x1="0" y1="25" x2="0" y2="50"/><line x1="0" y1="50" x2="25" y2="50"/><circle cx="0" cy="50" r="4"/></svg>
    <svg class="svg-border-art" style="position:absolute;bottom:-8px;right:-8px;width:50px;height:50px;"><line x1="50" y1="25" x2="50" y2="50"/><line x1="50" y1="50" x2="25" y2="50"/><circle cx="50" cy="50" r="4"/></svg>
  </div>

  <div style="margin-top:28px;background:var(--warm-bg);border-radius:14px;padding:28px;">
    <h3 style="font-family:'VTC Du Bois',serif;font-size:1.15rem;margin-bottom:14px;">Why has the college gap widened?</h3>
    <div class="grid-2" style="margin-top:0;">
      <div style="display:flex;align-items:flex-start;gap:10px;"><span style="font-size:1.4rem;">$</span><p style="font-size:.9rem;">Cost of college vs. free public K-12 education</p></div>
      <div style="display:flex;align-items:flex-start;gap:10px;"><span style="font-size:1.4rem;">&#8593;</span><p style="font-size:.9rem;">The role of generational wealth in affording higher education</p></div>
      <div style="display:flex;align-items:flex-start;gap:10px;"><span style="font-size:1.4rem;">&#9875;</span><p style="font-size:.9rem;">Structural barriers: legacy admissions, standardized testing</p></div>
      <div style="display:flex;align-items:flex-start;gap:10px;"><span style="font-size:1.4rem;">&#9878;</span><p style="font-size:.9rem;">Disproportionate student loan debt burden</p></div>
    </div>
  </div>

  <!-- DRAG AND DROP ACTIVITY -->
  <div class="dnd-activity" id="dndActivity" style="margin-top:24px;">
    <h4>Match the Factor: Closing or Widening?</h4>
    <p>Drag each factor to whether it explains the <strong>closing</strong> high school gap or the <strong>widening</strong> college gap.</p>
    <div class="dnd-items" id="dndItems">
      <div class="dnd-chip" draggable="true" data-factor="Free public K-12" data-target="closing">Free public K-12</div>
      <div class="dnd-chip" draggable="true" data-factor="Rising college costs" data-target="widening">Rising college costs</div>
      <div class="dnd-chip" draggable="true" data-factor="Desegregation laws" data-target="closing">Desegregation laws</div>
      <div class="dnd-chip" draggable="true" data-factor="Student loan burden" data-target="widening">Student loan burden</div>
      <div class="dnd-chip" draggable="true" data-factor="Federal education funding" data-target="closing">Federal education funding</div>
      <div class="dnd-chip" draggable="true" data-factor="Legacy admissions" data-target="widening">Legacy admissions</div>
    </div>
    <div class="dnd-targets">
      <div class="dnd-zone zone-close" id="dndClosing" data-zone="closing">
        <h5>Closing the HS Gap</h5>
      </div>
      <div class="dnd-zone zone-widen" id="dndWidening" data-zone="widening">
        <h5>Widening the College Gap</h5>
      </div>
    </div>
    <div class="dnd-complete" id="dndComplete">All factors matched correctly! You understand the structural forces behind these trends.</div>
  </div>

  <div class="scholar-only" style="margin-top:20px;background:#fff;border-radius:12px;padding:24px;border-left:4px solid var(--crimson);">
    <h4 style="font-family:'VTC Du Bois',serif;color:var(--crimson);margin-bottom:8px;">Scholar Discussion</h4>
    <p style="font-size:.92rem;color:#555;">Which gap matters more &mdash; the one that's closing (high school) or the one that's widening (college)? What structural factors explain each trajectory? What would Du Bois say about these trends?</p>
    <textarea style="width:100%;height:90px;margin-top:10px;border:2px solid #ddd;border-radius:8px;padding:10px;font-family:inherit;font-size:.9rem;resize:vertical;" placeholder="Write your analysis..."></textarea>
  </div>
</section>

<div class="parallax-divider" data-parallax><div class="parallax-svg"><svg viewBox="0 0 400 100"><circle cx="200" cy="50" r="45" fill="none" stroke="var(--gold)" stroke-width="1"/><circle cx="200" cy="50" r="35" fill="none" stroke="var(--gold)" stroke-width="1"/><circle cx="200" cy="50" r="25" fill="none" stroke="var(--gold)" stroke-width="1"/><circle cx="200" cy="50" r="15" fill="none" stroke="var(--gold)" stroke-width="1"/></svg></div><div class="parallax-line"></div></div>

<!-- SECTION 6: OCCUPATION TRANSFORMATION -->
<section class="lesson-section reveal" id="sec6" data-sec="6">
  <span class="section-tag">Section 6 of 9</span>
  <h2 class="sec-title">From Farms to Offices: A 125-Year Transformation</h2>
  <p class="sec-sub">Du Bois documented Black American occupations in 1900. The transformation since then has been extraordinary.</p>

  <div class="chart-wrap svg-border-target" id="occChartBorder">
    <h3 style="font-family:'VTC Du Bois',serif;text-align:center;margin-bottom:16px;">Black American Occupation Distribution (1900&ndash;2023)</h3>
    <canvas id="occChart" width="700" height="380"></canvas>
    <svg class="svg-border-art" style="position:absolute;top:-8px;left:-8px;width:50px;height:50px;"><line x1="0" y1="25" x2="0" y2="0"/><line x1="0" y1="0" x2="25" y2="0"/><circle cx="0" cy="0" r="4"/></svg>
    <svg class="svg-border-art" style="position:absolute;top:-8px;right:-8px;width:50px;height:50px;"><line x1="50" y1="25" x2="50" y2="0"/><line x1="50" y1="0" x2="25" y2="0"/><circle cx="50" cy="0" r="4"/></svg>
    <svg class="svg-border-art" style="position:absolute;bottom:-8px;left:-8px;width:50px;height:50px;"><line x1="0" y1="25" x2="0" y2="50"/><line x1="0" y1="50" x2="25" y2="50"/><circle cx="0" cy="50" r="4"/></svg>
    <svg class="svg-border-art" style="position:absolute;bottom:-8px;right:-8px;width:50px;height:50px;"><line x1="50" y1="25" x2="50" y2="50"/><line x1="50" y1="50" x2="25" y2="50"/><circle cx="50" cy="50" r="4"/></svg>
    <div class="chart-legend">
      <div class="legend-item"><div class="legend-dot" style="background:#6B4226;"></div>Agriculture</div>
      <div class="legend-item"><div class="legend-dot" style="background:#E8C840;"></div>Domestic Service</div>
      <div class="legend-item"><div class="legend-dot" style="background:#2D5A3D;"></div>Manual/Production</div>
      <div class="legend-item"><div class="legend-dot" style="background:#C41E3A;"></div>Sales/Office</div>
      <div class="legend-item"><div class="legend-dot" style="background:#1a1a1a;"></div>Professional/Mgmt</div>
    </div>
    <div class="chart-notes">
      <div class="chart-note then-n"><strong>Then (1900)</strong>87% of Black workers were in Agriculture or Domestic Service. Only 1% were in professional roles.</div>
      <div class="chart-note now-n"><strong>Now (2023)</strong>Professional/Management is the largest category at 36% &mdash; a 36-fold increase. Agriculture has virtually disappeared (0.4%).</div>
    </div>
  </div>

  <div class="explorer-only" style="margin-top:16px;text-align:center;">
    <p style="font-size:.92rem;color:var(--brown);background:rgba(197,165,90,.15);display:inline-block;padding:10px 18px;border-radius:8px;"><strong>Mind-Blowing Stat:</strong> In 1900, for every 1 Black professional, there were 62 Black agricultural workers. Today, for every 1 agricultural worker, there are 90 professionals!</p>
  </div>

  <div class="scholar-only" style="margin-top:16px;">
    <div class="challenge" style="max-width:100%;">
      <h4>Scholar Challenge: Calculate the Fold-Increase</h4>
      <p>For each category, calculate how much it changed from 1900 to 2023:</p>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:10px;">
        <div><label style="font-size:.85rem;font-weight:600;">Professional: 1% &rarr; 36% = ?x increase</label><input type="number" class="ch-input" id="profCalc" style="margin-top:4px;" placeholder="?"><div id="profFb" class="ch-feedback" style="font-size:.82rem;"></div></div>
        <div><label style="font-size:.85rem;font-weight:600;">Agriculture: 62% &rarr; 0.4% = ?x decrease</label><input type="number" class="ch-input" id="agCalc" style="margin-top:4px;" placeholder="?"><div id="agFb" class="ch-feedback" style="font-size:.82rem;"></div></div>
      </div>
      <button class="ch-btn" style="margin-top:12px;" onclick="checkAnswer('profCalc',36,2,'profFb');checkAnswer('agCalc',155,15,'agFb')">Check Answers</button>
    </div>
  </div>
</section>

<div class="parallax-divider" data-parallax><div class="parallax-svg"><svg viewBox="0 0 400 100"><line x1="200" y1="50" x2="200" y2="5" stroke="var(--gold)" stroke-width="1"/><line x1="200" y1="50" x2="350" y2="15" stroke="var(--gold)" stroke-width="1"/><line x1="200" y1="50" x2="350" y2="85" stroke="var(--gold)" stroke-width="1"/><line x1="200" y1="50" x2="200" y2="95" stroke="var(--gold)" stroke-width="1"/><line x1="200" y1="50" x2="50" y2="85" stroke="var(--gold)" stroke-width="1"/><line x1="200" y1="50" x2="50" y2="15" stroke="var(--gold)" stroke-width="1"/></svg></div><div class="parallax-line"></div></div>

<!-- SECTION 7: PROFESSIONAL GAP -->
<section class="lesson-section reveal" id="sec7" data-sec="7">
  <span class="section-tag">Section 7 of 9</span>
  <h2 class="sec-title">The Professional Gap: Massive Progress, But Parity Remains Elusive</h2>
  <p class="sec-sub">Two ways to look at the same data tell very different stories. Which perspective matters more?</p>

  <div class="view-toggle">
    <button class="vt-btn active" onclick="showView('absolute',this)">Absolute Progress</button>
    <button class="vt-btn" onclick="showView('gap',this)">Relative Gap</button>
  </div>

  <div class="view-panel active" id="view-absolute">
    <div style="text-align:center;margin:20px 0;">
      <canvas id="absChart" width="500" height="300"></canvas>
    </div>
    <p style="text-align:center;color:#666;max-width:550px;margin:0 auto;">Representation in professional jobs skyrocketed from <strong>1% to 36%</strong> &mdash; a <strong>36-fold increase.</strong> By this measure, the progress is extraordinary.</p>
  </div>

  <div class="view-panel" id="view-gap">
    <div style="text-align:center;margin:20px 0;">
      <canvas id="gapBarChart" width="600" height="300"></canvas>
    </div>
    <p style="text-align:center;color:#666;max-width:550px;margin:0 auto;">In 1900: White 10%, Black 1% (9-point gap). In 2023: White 44%, Black 36% (8-point gap). The gap has <strong>barely changed</strong> even as representation skyrocketed.</p>
  </div>

  <div style="margin-top:24px;background:rgba(139,26,26,.06);border:2px solid var(--crimson);border-radius:12px;padding:24px;text-align:center;">
    <p style="font-family:'VTC Du Bois',serif;font-size:1.1rem;font-weight:700;">Critical Question: Which is a better measure of success &mdash; achieving ambitious goals (absolute progress) or closing the gap (relative parity)?</p>
  </div>

  <div class="scholar-only" style="margin-top:20px;">
    <div class="card" style="border-left:4px solid var(--crimson);">
      <h3>Scholar: Defend Your Position</h3>
      <p>Write a paragraph arguing for EITHER absolute progress OR relative parity as the better measure of success. Use specific data from this lesson.</p>
      <textarea style="width:100%;height:100px;margin-top:10px;border:2px solid #ddd;border-radius:8px;padding:10px;font-family:inherit;font-size:.9rem;resize:vertical;" placeholder="I believe that... because the data shows..."></textarea>
    </div>
  </div>
</section>

<div class="parallax-divider" data-parallax><div class="parallax-svg"><svg viewBox="0 0 400 100"><polygon points="200,10 240,35 240,65 200,90 160,65 160,35" fill="none" stroke="var(--gold)" stroke-width="1"/><polygon points="200,20 230,38 230,62 200,80 170,62 170,38" fill="none" stroke="var(--gold)" stroke-width="1"/><polygon points="200,30 220,42 220,58 200,70 180,58 180,42" fill="none" stroke="var(--gold)" stroke-width="1"/></svg></div><div class="parallax-line"></div></div>

<!-- SECTION 8: LEGACY & SENSORY -->
<section class="lesson-section reveal" id="sec8" data-sec="8">
  <span class="section-tag">Section 8 of 9</span>
  <h2 class="sec-title">Du Bois's Legacy is Our Toolkit</h2>
  <p class="sec-sub">His methods are the foundation of modern data journalism and evidence-based policy.</p>

  <div class="grid-3">
    <div class="card"><h3>Pioneer</h3><p>He pioneered American sociology, using empirical data to prove that <strong>social disparities result from structural barriers</strong>, not inherent differences.</p></div>
    <div class="card"><h3>Foundation</h3><p>His methods laid the groundwork for modern data journalism: <strong>The Upshot</strong> (NYT), <strong>FiveThirtyEight</strong>, <strong>The Pudding</strong> &mdash; all descendants of his approach.</p></div>
    <div class="card"><h3>Relevance</h3><p>His core idea &mdash; using data to make marginalized communities <strong>visible</strong> and counter false narratives &mdash; is more relevant than ever in the era of big data.</p></div>
  </div>

  <h3 style="font-family:'VTC Du Bois',serif;margin-top:40px;margin-bottom:8px;">If You Visited the Exhibit: Connecting Data to a Sensory Experience</h3>
  <p style="color:#666;font-size:.92rem;margin-bottom:20px;">The <em>Du Bois Does Data</em> exhibit used scent, sound, and touch to bring data to life. Click each card to explore the connection.</p>

  <div class="sensory-grid">
    <div class="sensory-card" onclick="this.classList.toggle('open');sfxClick();">
      <div class="sensory-icon">&#127811;</div>
      <h4>The Scent</h4>
      <p>Vetiver &mdash; "the soil of Ghana and Georgia"</p>
      <div class="sensory-detail">The exhibit featured a custom scent with base notes of Vetiver, described as "the soil of Ghana and Georgia." How did smelling the earth connect visitors to the data on agricultural labor and migration? The scent bridged the abstract numbers to the physical reality of working the land.</div>
    </div>
    <div class="sensory-card" onclick="this.classList.toggle('open');sfxClick();">
      <div class="sensory-icon">&#127925;</div>
      <h4>The Sound</h4>
      <p>Curated jazz from the dawn of the Jazz Age</p>
      <div class="sensory-detail">Listening stations played curated jazz music. Du Bois's work happened at the dawn of the Jazz Age. The music's themes of struggle and resilience echoed the story told in the data &mdash; creativity and beauty born from hardship.</div>
    </div>
    <div class="sensory-card" onclick="this.classList.toggle('open');sfxClick();">
      <div class="sensory-icon">&#128214;</div>
      <h4>The Texture</h4>
      <p>Raw cotton and the Africana encyclopedia</p>
      <div class="sensory-detail">The space included raw cotton and the leather-bound Africana encyclopedia. Touching these objects traced the journey from agricultural labor to intellectual leadership &mdash; the same story Du Bois told with his charts 125 years ago.</div>
    </div>
  </div>

  <div class="scholar-only" style="margin-top:20px;background:#fff;border-radius:12px;padding:24px;border-left:4px solid var(--gold);">
    <h4 style="font-family:'VTC Du Bois',serif;color:var(--brown);margin-bottom:8px;">Scholar Reflection</h4>
    <p style="font-size:.92rem;color:#555;">How does engaging multiple senses change our understanding of data? Does adding scent, sound, and texture to a data exhibit make the information more or less "objective"? What would Du Bois think?</p>
    <textarea style="width:100%;height:80px;margin-top:10px;border:2px solid #ddd;border-radius:8px;padding:10px;font-family:inherit;font-size:.9rem;resize:vertical;" placeholder="Write your reflection..."></textarea>
  </div>
</section>

<div class="parallax-divider" data-parallax><div class="parallax-svg"><svg viewBox="0 0 400 100"><path d="M200,10 Q220,25 210,50 Q200,75 220,90" fill="none" stroke="var(--gold)" stroke-width="1"/><path d="M190,10 Q170,30 185,50 Q200,70 180,90" fill="none" stroke="var(--gold)" stroke-width="1"/><path d="M210,10 Q240,30 220,55 Q200,80 230,95" fill="none" stroke="var(--gold)" stroke-width="1"/></svg></div><div class="parallax-line"></div></div>

<!-- SECTION 9: ARGUMENT + QUIZ + VOCAB + CLOSING -->
<section class="lesson-section reveal" id="sec9" data-sec="9">
  <span class="section-tag">Section 9 of 9</span>
  <h2 class="sec-title">Your Turn: Use the Evidence to Build an Argument</h2>
  <p class="sec-sub">Choose ONE prompt and defend your position using specific evidence from the data.</p>

  <div class="grid-2">
    <div class="prompt-card">
      <h3>Prompt 1: Methodology Assessment</h3>
      <p>Du Bois chose to <strong>respond to racism with data visualization</strong> rather than emotional appeals or moral arguments. Evaluate the effectiveness of this strategy. What did data accomplish that other approaches could not? What limitations did this approach have?</p>
      <textarea placeholder="Write your response... Use specific data points from the lesson."></textarea>
    </div>
    <div class="prompt-card">
      <h3>Prompt 2: Progress vs. Parity</h3>
      <p>The data shows <strong>massive absolute progress</strong> alongside <strong>persistent relative gaps.</strong> Which matters more: absolute progress or relative parity? Defend your position using specific evidence.</p>
      <textarea placeholder="Write your response... Reference education gaps, occupation data, or population trends."></textarea>
    </div>
  </div>
</section>

<!-- QUIZ -->
<div class="quiz-box reveal" id="quizSection">
  <span class="section-tag" style="background:var(--gold);color:var(--black);">Knowledge Check</span>
  <h2 style="font-family:'VTC Du Bois',serif;color:#fff;font-size:1.6rem;margin-bottom:4px;">Final Quiz</h2>
  <p style="color:#999;font-size:.95rem;margin-bottom:20px;">Test your understanding of Du Bois's data revolution.</p>
  <div class="q-progress"><div class="q-bar" id="qBar" style="width:0%"></div></div>
  <div id="qContainer"></div>
  <div class="q-score" id="qScore">
    <h3 id="scoreTitle"></h3>
    <p id="scoreText"></p>
    <button class="q-restart" onclick="restartQuiz()">Try Again</button>
    <button class="cert-btn" id="getCertBtn" onclick="openCert()" style="display:none;">Get Certificate</button>
  </div>
</div>

<!-- VOCABULARY -->
<section class="lesson-section reveal" id="vocabSec">
  <h2 class="sec-title">Key Vocabulary</h2>
  <p class="sec-sub">Master these terms to think critically about data and justice.</p>

  <div class="explorer-only">
    <h3 style="font-family:'VTC Du Bois',serif;font-size:1.1rem;margin-bottom:8px;">Flashcard Game &mdash; Click to reveal, then navigate</h3>
    <div class="fc-container">
      <div class="fc-card" id="fcCard" onclick="this.classList.toggle('show-def');sfxClick();vocabFlipped.add(fcIdx);if(vocabFlipped.size>=6)awardBadge('vocab-master');">
        <div class="fc-term" id="fcTerm"></div>
        <div class="fc-def" id="fcDef"></div>
        <p style="font-size:.75rem;color:#bbb;margin-top:12px;">Click to flip</p>
      </div>
      <div class="fc-nav">
        <button onclick="fcNav(-1)">&#9664; Prev</button>
        <span id="fcCount" style="font-size:.85rem;color:#888;align-self:center;"></span>
        <button onclick="fcNav(1)">Next &#9654;</button>
      </div>
    </div>
  </div>

  <div class="scholar-only">
    <p style="font-size:.92rem;color:#666;margin-bottom:16px;">Write each definition <strong>in your own words</strong> to deepen understanding.</p>
  </div>

  <div class="vocab-grid">
    <div class="vocab-card"><h4>Data Visualization</h4><p>The graphical representation of information to reveal patterns and insights.</p><div class="scholar-only"><input type="text" style="width:100%;margin-top:8px;padding:8px;border:1px solid #ddd;border-radius:6px;font-size:.85rem;" placeholder="Your definition..."></div></div>
    <div class="vocab-card"><h4>Pseudoscience</h4><p>Beliefs mistakenly regarded as based on the scientific method. Du Bois fought this with real data.</p><div class="scholar-only"><input type="text" style="width:100%;margin-top:8px;padding:8px;border:1px solid #ddd;border-radius:6px;font-size:.85rem;" placeholder="Your definition..."></div></div>
    <div class="vocab-card"><h4>Empirical Data</h4><p>Evidence collected through direct observation and measurement.</p><div class="scholar-only"><input type="text" style="width:100%;margin-top:8px;padding:8px;border:1px solid #ddd;border-radius:6px;font-size:.85rem;" placeholder="Your definition..."></div></div>
    <div class="vocab-card"><h4>Structural Inequality</h4><p>When societal systems and institutions produce unequal outcomes for different groups.</p><div class="scholar-only"><input type="text" style="width:100%;margin-top:8px;padding:8px;border:1px solid #ddd;border-radius:6px;font-size:.85rem;" placeholder="Your definition..."></div></div>
    <div class="vocab-card"><h4>Absolute Progress</h4><p>An increase in a metric for a group over time (e.g., higher income, more graduates).</p><div class="scholar-only"><input type="text" style="width:100%;margin-top:8px;padding:8px;border:1px solid #ddd;border-radius:6px;font-size:.85rem;" placeholder="Your definition..."></div></div>
    <div class="vocab-card"><h4>Relative Gap (Parity)</h4><p>The difference or ratio between two groups for a given metric (e.g., the wealth gap).</p><div class="scholar-only"><input type="text" style="width:100%;margin-top:8px;padding:8px;border:1px solid #ddd;border-radius:6px;font-size:.85rem;" placeholder="Your definition..."></div></div>
  </div>
</section>

<!-- CLOSING -->
<div class="closing" style="max-width:100%;">
  <blockquote id="closingQuote" data-typewriter="&quot;Imagine what we might be if we grow to what we wish.&quot;"></blockquote>
  <cite>&mdash; W.E.B. Du Bois</cite>
  <p style="color:#888;margin-top:20px;font-size:.95rem;">&ldquo;What we Americans want is freedom to know the truth and the right to think and to act as seems wisest to us under the democratic process.&rdquo;</p>
  <div class="closing-links">
    <a href="index.html" class="closing-link cl-hub">Back to Hub</a>
    <a href="lesson1-detective.html" class="closing-link cl-l1">Try Lesson 1</a>
  </div>
</div>

<!-- CERTIFICATE MODAL -->
<div class="cert-overlay" id="certOverlay">
  <div class="cert-modal" id="certModal">
    <h2>Certificate of Achievement</h2>
    <h3>Du Bois Data Analysis Program</h3>
    <div id="certForm">
      <p style="font-size:.9rem;color:#666;margin-bottom:12px;">Enter your name to generate your certificate:</p>
      <input type="text" class="cert-input" id="certName" placeholder="Your Name">
      <br>
      <button class="cert-btn" onclick="generateCert()">Generate Certificate</button>
    </div>
    <div id="certResult" style="display:none;">
      <p style="font-size:.85rem;color:#888;margin-bottom:8px;">This certifies that</p>
      <div class="cert-name" id="certDisplayName"></div>
      <div class="cert-details">
        <p>Has successfully completed the <strong>Du Bois Does Data</strong> curriculum</p>
        <p>Quiz Score: <strong id="certScore"></strong> | Rank: <strong id="certRank"></strong></p>
        <p>Date: <strong id="certDate"></strong></p>
      </div>
      <p style="font-family:'VTC Du Bois',serif;font-style:italic;color:var(--brown);font-size:.95rem;margin-top:16px;">"The problem of the twentieth century is the problem of the color line."</p>
      <div class="cert-actions">
        <button class="cert-print" onclick="window.print()">Print Certificate</button>
        <button class="cert-close" onclick="closeCert()">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- SOUND TOGGLE -->
<button class="sound-toggle" id="soundToggle" onclick="toggleSound()" title="Toggle sounds">&#128264;</button>

<!-- BADGE SYSTEM -->
<button class="badge-toggle" id="badgeToggle" onclick="toggleBadgeDrawer()" title="View achievements">&#127942;</button>
<div class="badge-drawer" id="badgeDrawer">
  <h3>Achievements</h3>
  <div id="badgeList"></div>
</div>
<div class="badge-toast" id="badgeToast"></div>

<footer>
  <p>Based on <strong>Du Bois Does Data</strong> &bull; An educational resource exploring data visualization as a tool for activism, from the 1900 Paris Exhibition to today.</p>
</footer>

<script>
// ===== MODE =====
const params = new URLSearchParams(location.search);
let mode = params.get('mode') || localStorage.getItem('dubois-mode') || 'explorer';
function applyMode(m) {
  mode = m;
  localStorage.setItem('dubois-mode', m);
  document.body.className = 'mode-' + m;
  document.getElementById('modeBtn').textContent = m === 'explorer' ? 'Explorer' : 'Scholar';
}
function toggleMode() {
  applyMode(mode === 'explorer' ? 'scholar' : 'explorer');
}
applyMode(mode);

// ===== PROGRESS =====
const allSections = document.querySelectorAll('[data-sec]');
const indicator = document.getElementById('secIndicator');
const progressFill = document.getElementById('progressFill');
function updateProgress() {
  const scrollY = window.scrollY + window.innerHeight * 0.4;
  let current = 0;
  allSections.forEach(s => { if (scrollY >= s.offsetTop) current = parseInt(s.dataset.sec); });
  const pct = Math.min(100, (current / 9) * 100);
  progressFill.style.width = pct + '%';
  if (current > 0) indicator.textContent = 'Section ' + current + ' of 9';
  else indicator.textContent = 'Introduction';
}
window.addEventListener('scroll', updateProgress);
updateProgress();

// ===== REVEAL =====
const obs = new IntersectionObserver(entries => {
  entries.forEach(e => { if (e.isIntersecting) { e.target.classList.add('visible'); triggerCharts(e.target); } });
}, { threshold: 0.12 });
document.querySelectorAll('.reveal').forEach(el => obs.observe(el));

// ===== TABS =====
function showTab(id, btn) {
  const parent = btn.closest('.lesson-section') || btn.closest('section');
  parent.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));
  parent.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  document.getElementById('panel-' + id).classList.add('active');
  btn.classList.add('active');
  sfxClick();
  // Track migration tabs for badge
  if(['then4','mig4','now4'].includes(id)){migTabsViewed.add(id);if(migTabsViewed.size>=3)awardBadge('migration-expert');}
}

// ===== VIEW TOGGLE =====
function showView(id, btn) {
  document.querySelectorAll('.view-panel').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.vt-btn').forEach(b => b.classList.remove('active'));
  document.getElementById('view-' + id).classList.add('active');
  btn.classList.add('active');
  if (id === 'absolute' && !absDrawn) drawAbsChart();
  if (id === 'gap' && !gapBarDrawn) drawGapBarChart();
  sfxClick();
  viewsViewed.add(id);if(viewsViewed.size>=2)awardBadge('gap-analyst');
}

// ===== CHALLENGES =====
function checkAnswer(inputId, answer, tol, fbId) {
  const val = parseFloat(document.getElementById(inputId).value);
  const fb = document.getElementById(fbId);
  fb.className = 'ch-feedback';
  if (isNaN(val)) { fb.textContent = 'Please enter a number!'; fb.classList.add('wrong'); return; }
  if (Math.abs(val - answer) <= tol) {
    fb.textContent = 'Correct! The answer is approximately ' + answer + '.';
    fb.classList.add('correct');sfxSuccess();
  } else {
    fb.textContent = 'Not quite. Try again!';
    fb.classList.add('wrong');sfxClick();
  }
}

// ===== CHARTS =====
let mapDrawn=false, gapDrawn=false, occDrawn=false, absDrawn=false, gapBarDrawn=false;

function triggerCharts(el) {
  if (el.querySelector('#mapCanvas') && !mapDrawn) drawMap();
  if (el.querySelector('#gapChart') && !gapDrawn) drawGapChart();
  if (el.querySelector('#occChart') && !occDrawn) drawOccChart();
  if (el.querySelector('#absChart') && !absDrawn) drawAbsChart();
}

// MAP (simplified US regions)
function drawMap() {
  mapDrawn = true;
  const c = document.getElementById('mapCanvas'), ctx = c.getContext('2d');
  const W = c.width, H = c.height;
  ctx.fillStyle = '#faf8f4'; ctx.fillRect(0,0,W,H);

  // Simplified state shapes as labeled rectangles in approximate positions
  const states = [
    // Southern states (red)
    {n:'TX',x:200,y:340,w:80,h:60,s:true},{n:'LA',x:300,y:340,w:50,h:40,s:true},
    {n:'MS',x:360,y:310,w:40,h:60,s:true},{n:'AL',x:405,y:310,w:40,h:60,s:true},
    {n:'GA',x:450,y:310,w:45,h:55,s:true},{n:'FL',x:470,y:370,w:50,h:50,s:true},
    {n:'SC',x:500,y:290,w:40,h:35,s:true},{n:'NC',x:500,y:255,w:60,h:30,s:true},
    {n:'VA',x:500,y:225,w:55,h:28,s:true},{n:'TN',x:410,y:270,w:70,h:30,s:true},
    {n:'AR',x:310,y:290,w:50,h:40,s:true},{n:'OK',x:260,y:270,w:55,h:35,s:true},
    {n:'KY',x:430,y:240,w:60,h:25,s:true},{n:'WV',x:490,y:215,w:30,h:30,s:true},
    // Northern / Western states (tan)
    {n:'NY',x:540,y:140,w:45,h:50,s:false},{n:'PA',x:510,y:180,w:50,h:35,s:false},
    {n:'OH',x:450,y:195,w:45,h:40,s:false},{n:'IN',x:420,y:200,w:30,h:40,s:false},
    {n:'IL',x:380,y:190,w:35,h:55,s:false},{n:'MI',x:420,y:140,w:40,h:50,s:false},
    {n:'WI',x:370,y:130,w:40,h:45,s:false},{n:'MN',x:310,y:110,w:50,h:45,s:false},
    {n:'IA',x:320,y:175,w:45,h:35,s:false},{n:'MO',x:330,y:230,w:50,h:45,s:false},
    {n:'KS',x:260,y:230,w:55,h:35,s:false},{n:'NE',x:260,y:180,w:60,h:30,s:false},
    {n:'SD',x:260,y:140,w:55,h:30,s:false},{n:'ND',x:260,y:105,w:55,h:30,s:false},
    {n:'MT',x:170,y:80,w:70,h:40,s:false},{n:'WY',x:185,y:135,w:55,h:35,s:false},
    {n:'CO',x:195,y:195,w:55,h:35,s:false},{n:'NM',x:185,y:270,w:50,h:55,s:false},
    {n:'AZ',x:130,y:270,w:50,h:55,s:false},{n:'UT',x:140,y:190,w:40,h:50,s:false},
    {n:'NV',x:95,y:185,w:35,h:55,s:false},{n:'ID',x:120,y:115,w:40,h:60,s:false},
    {n:'WA',x:80,y:60,w:55,h:40,s:false},{n:'OR',x:65,y:105,w:55,h:40,s:false},
    {n:'CA',x:55,y:175,w:40,h:100,s:false},
    {n:'ME',x:590,y:80,w:30,h:50,s:false},{n:'MA',x:580,y:148,w:25,h:18,s:false},
    {n:'CT',x:565,y:168,w:22,h:14,s:false},{n:'NJ',x:555,y:195,w:18,h:25,s:false},
    {n:'DE',x:538,y:215,w:14,h:16,s:false},{n:'MD',x:520,y:218,w:20,h:14,s:false},
  ];

  // Title
  ctx.fillStyle = var_black; ctx.font = 'bold 16px VTC Du Bois, serif';
  ctx.textAlign = 'center'; ctx.fillText('UNITED STATES, 1900', W/2, 28);
  ctx.font = '12px Inter'; ctx.fillStyle = '#999';
  ctx.fillText('Southern states (former slave states) highlighted in red', W/2, 48);

  states.forEach(st => {
    ctx.fillStyle = st.s ? '#8B1A1A' : '#e8dcc8';
    ctx.strokeStyle = st.s ? '#6a1414' : '#ccc';
    ctx.lineWidth = 1;
    ctx.fillRect(st.x, st.y, st.w, st.h);
    ctx.strokeRect(st.x, st.y, st.w, st.h);
    ctx.fillStyle = st.s ? '#fff' : '#888';
    ctx.font = st.w < 25 ? '8px Inter' : '10px Inter';
    ctx.textAlign = 'center';
    ctx.fillText(st.n, st.x + st.w/2, st.y + st.h/2 + 4);
  });

  // Legend
  ctx.fillStyle = '#8B1A1A'; ctx.fillRect(540, 360, 16, 16);
  ctx.fillStyle = '#e8dcc8'; ctx.fillRect(540, 384, 16, 16); ctx.strokeStyle='#ccc'; ctx.strokeRect(540,384,16,16);
  ctx.fillStyle = '#555'; ctx.font = '12px Inter'; ctx.textAlign = 'left';
  ctx.fillText('Southern (slave) states', 564, 373);
  ctx.fillText('Other states', 564, 397);

  // Big stat
  ctx.fillStyle = var_crimson; ctx.font = 'bold 36px VTC Du Bois, serif';
  ctx.textAlign = 'right'; ctx.fillText('90%', W - 30, 110);
  ctx.font = '14px Inter'; ctx.fillStyle = '#666';
  ctx.fillText('of Black Americans', W - 30, 130);
  ctx.fillText('lived in the South', W - 30, 148);
}
const var_black = '#1a1a1a', var_crimson = '#8B1A1A';

// GAP CHART
function drawGapChart() {
  gapDrawn = true;
  const c = document.getElementById('gapChart'), ctx = c.getContext('2d');
  const W = c.width, H = c.height;
  const pad = {t:50,r:40,b:50,l:55};
  ctx.fillStyle = '#faf8f4'; ctx.fillRect(0,0,W,H);

  const years = [1940,1960,1980,2000,2020];
  // HS: White, Black
  const hsW = [24.2,36.4,56.2,78.8,94.3];
  const hsB = [7.3,20.1,51.2,72.3,90.1];
  // BA: White, Black
  const baW = [4.9,8.1,17.1,26.1,32.9];
  const baB = [1.3,3.1,8.4,15.5,20.4];

  const xS = i => pad.l + i/(years.length-1)*(W-pad.l-pad.r);
  const yS = v => H - pad.b - v/100*(H-pad.t-pad.b);

  // Grid
  ctx.strokeStyle='#e0d8c8';ctx.lineWidth=1;
  for(let v=0;v<=100;v+=20){ctx.beginPath();ctx.moveTo(pad.l,yS(v));ctx.lineTo(W-pad.r,yS(v));ctx.stroke();ctx.fillStyle='#999';ctx.font='11px Inter';ctx.textAlign='right';ctx.fillText(v+'%',pad.l-8,yS(v)+4);}
  ctx.textAlign='center';ctx.fillStyle='#999';
  years.forEach((y,i)=>ctx.fillText(y,xS(i),H-pad.b+20));

  // Titles
  ctx.fillStyle=var_black;ctx.font='bold 14px VTC Du Bois, serif';ctx.textAlign='center';
  ctx.fillText('High School Completion Gap (closing)',W*0.35,25);
  ctx.fillStyle=var_crimson;
  ctx.fillText("Bachelor's Degree Gap (widening)",W*0.7,25);

  function drawLine(data,color,dash){
    ctx.strokeStyle=color;ctx.lineWidth=3;ctx.setLineDash(dash||[]);ctx.lineJoin='round';
    ctx.beginPath();data.forEach((v,i)=>{const x=xS(i),y=yS(v);i===0?ctx.moveTo(x,y):ctx.lineTo(x,y);});ctx.stroke();ctx.setLineDash([]);
    data.forEach((v,i)=>{ctx.beginPath();ctx.arc(xS(i),yS(v),5,0,Math.PI*2);ctx.fillStyle=color;ctx.fill();});
  }

  // HS lines
  drawLine(hsW,'#C5A55A');drawLine(hsB,'#E8C840',[6,4]);
  // Fill between (yellow)
  ctx.beginPath();
  hsW.forEach((v,i)=>i===0?ctx.moveTo(xS(i),yS(v)):ctx.lineTo(xS(i),yS(v)));
  for(let i=hsB.length-1;i>=0;i--)ctx.lineTo(xS(i),yS(hsB[i]));
  ctx.closePath();ctx.fillStyle='rgba(232,200,64,0.18)';ctx.fill();

  // BA lines
  drawLine(baW,'#C41E3A');drawLine(baB,'#8B1A1A',[6,4]);
  // Fill between (red)
  ctx.beginPath();
  baW.forEach((v,i)=>i===0?ctx.moveTo(xS(i),yS(v)):ctx.lineTo(xS(i),yS(v)));
  for(let i=baB.length-1;i>=0;i--)ctx.lineTo(xS(i),yS(baB[i]));
  ctx.closePath();ctx.fillStyle='rgba(196,30,58,0.12)';ctx.fill();

  // Annotations
  ctx.font='bold 11px Inter';
  ctx.fillStyle='#C5A55A';ctx.fillText('White HS',xS(4)+10,yS(hsW[4])-8);
  ctx.fillStyle='#E8C840';ctx.fillText('Black HS',xS(4)+10,yS(hsB[4])+16);
  ctx.fillStyle='#C41E3A';ctx.fillText('White BA',xS(4)+10,yS(baW[4])-8);
  ctx.fillStyle='#8B1A1A';ctx.fillText('Black BA',xS(4)+10,yS(baB[4])+16);

  // Gap labels
  ctx.font='bold 12px Inter';
  ctx.fillStyle='#888';ctx.textAlign='left';
  ctx.fillText('Gap: 16.9pts',xS(0)-40,yS((hsW[0]+hsB[0])/2));
  ctx.fillText('Gap: 4.2pts',xS(4)+4,yS((hsW[4]+hsB[4])/2));
  ctx.fillText('Gap: 3.6pts',xS(0)-40,yS((baW[0]+baB[0])/2));
  ctx.fillText('Gap: 12.5pts',xS(4)+4,yS((baW[4]+baB[4])/2));
}

// OCCUPATION STACKED AREA
function drawOccChart() {
  occDrawn = true;
  const c = document.getElementById('occChart'), ctx = c.getContext('2d');
  const W = c.width, H = c.height;
  const pad = {t:30,r:50,b:45,l:45};
  const years=[1900,1925,1950,1975,2000,2023];
  const stacks=[[62,25,8,4,1],[45,28,14,7,6],[20,30,25,13,12],[4,22,28,22,24],[1,18,25,24,32],[0.4,17,23,24,36]];
  const colors=['#6B4226','#E8C840','#2D5A3D','#C41E3A','#1a1a1a'];
  ctx.fillStyle='#faf8f4';ctx.fillRect(0,0,W,H);
  const xS=i=>pad.l+i/(years.length-1)*(W-pad.l-pad.r);
  const yS=v=>H-pad.b-v/100*(H-pad.t-pad.b);

  for(let c2=0;c2<5;c2++){
    ctx.beginPath();
    for(let i=0;i<years.length;i++){let cm=0;for(let j=0;j<=c2;j++)cm+=stacks[i][j];const x=xS(i),y=yS(cm);i===0?ctx.moveTo(x,y):ctx.lineTo(x,y);}
    for(let i=years.length-1;i>=0;i--){let cm=0;for(let j=0;j<c2;j++)cm+=stacks[i][j];ctx.lineTo(xS(i),yS(cm));}
    ctx.closePath();ctx.fillStyle=colors[c2];ctx.fill();
  }

  ctx.fillStyle='#999';ctx.font='12px Inter';ctx.textAlign='center';
  years.forEach((y,i)=>ctx.fillText(y,xS(i),H-pad.b+20));
  ctx.textAlign='right';
  for(let v=0;v<=100;v+=20){ctx.fillStyle='#ccc';ctx.fillText(v+'%',pad.l-8,yS(v)+4);}

  // Right labels
  const last=xS(5);ctx.font='bold 11px Inter';ctx.textAlign='left';
  let cm2=0;['0.4%','17%','23%','24%','36%'].forEach((lbl,i)=>{
    cm2+=stacks[5][i];const mid=yS(cm2-stacks[5][i]/2);
    ctx.fillStyle=i<2?colors[i]:'#fff';
    ctx.fillText(lbl,last+6,mid+4);
  });
}

// ABSOLUTE PROGRESS
function drawAbsChart() {
  absDrawn = true;
  const c = document.getElementById('absChart'), ctx = c.getContext('2d');
  const W = c.width, H = c.height;
  ctx.fillStyle = '#faf8f4'; ctx.fillRect(0,0,W,H);
  const pad = {t:40,r:30,b:50,l:50};
  const barW = 80;

  // 1900 bar
  const x1 = W*0.3, h1 = (1/50)*(H-pad.t-pad.b), y1 = H-pad.b-h1;
  ctx.fillStyle = '#8B1A1A'; ctx.fillRect(x1-barW/2, y1, barW, h1);
  ctx.fillStyle = var_black; ctx.font='bold 16px Inter'; ctx.textAlign='center';
  ctx.fillText('1%', x1, y1-10);
  ctx.font='bold 13px Inter'; ctx.fillText('1900', x1, H-pad.b+20);

  // 2023 bar
  const x2 = W*0.7, h2 = (36/50)*(H-pad.t-pad.b), y2 = H-pad.b-h2;
  ctx.fillStyle = var_black; ctx.fillRect(x2-barW/2, y2, barW, h2);
  ctx.fillStyle = '#fff'; ctx.font='bold 18px Inter'; ctx.fillText('36%', x2, y2+30);
  ctx.fillStyle = var_black; ctx.font='bold 13px Inter'; ctx.fillText('2023', x2, H-pad.b+20);

  // Arrow
  ctx.fillStyle = '#C5A55A'; ctx.font='bold 28px VTC Du Bois, serif'; ctx.fillText('36x', W*0.5, H*0.35);
  ctx.font='14px Inter'; ctx.fillStyle='#888'; ctx.fillText('Increase', W*0.5, H*0.35+22);

  // Big arrow
  ctx.strokeStyle = '#C5A55A'; ctx.lineWidth=4;
  ctx.beginPath(); ctx.moveTo(x1+barW/2+10, y1); ctx.lineTo(x2-barW/2-10, y2+20); ctx.stroke();
  ctx.beginPath(); ctx.moveTo(x2-barW/2-10, y2+20); ctx.lineTo(x2-barW/2-20, y2+10); ctx.moveTo(x2-barW/2-10, y2+20); ctx.lineTo(x2-barW/2-20, y2+30); ctx.stroke();
}

// GAP BAR CHART
function drawGapBarChart() {
  gapBarDrawn = true;
  const c = document.getElementById('gapBarChart'), ctx = c.getContext('2d');
  const W = c.width, H = c.height;
  ctx.fillStyle = '#faf8f4'; ctx.fillRect(0,0,W,H);
  const pad = {t:40,r:20,b:50,l:50};
  const barW = 55, gap = 12;

  function drawPair(cx, w, b, yr, gapPts) {
    const yS = v => H-pad.b - v/50*(H-pad.t-pad.b);
    const hW = yS(w), hB = yS(b);
    // White bar
    ctx.fillStyle = '#ddd'; ctx.fillRect(cx-barW-gap/2, hW, barW, H-pad.b-hW);
    ctx.fillStyle = '#888'; ctx.font='bold 12px Inter'; ctx.textAlign='center';
    ctx.fillText('White', cx-barW/2-gap/2, H-pad.b+16);
    ctx.fillText(w+'%', cx-barW/2-gap/2, hW-8);
    // Black bar
    ctx.fillStyle = var_black; ctx.fillRect(cx+gap/2, hB, barW, H-pad.b-hB);
    ctx.fillStyle = var_black; ctx.fillText('Black', cx+barW/2+gap/2, H-pad.b+16);
    ctx.fillStyle = '#fff'; ctx.fillText(b+'%', cx+barW/2+gap/2, hB+20);
    // Year
    ctx.fillStyle = '#888'; ctx.font='bold 14px VTC Du Bois, serif';
    ctx.fillText(yr, cx, H-pad.b+34);
    // Gap bracket
    ctx.strokeStyle = var_crimson; ctx.lineWidth=2;
    const topG = Math.min(hW,hB), botG = Math.max(hW,hB);
    ctx.beginPath(); ctx.moveTo(cx+barW+gap, topG); ctx.lineTo(cx+barW+gap+10, topG);
    ctx.lineTo(cx+barW+gap+10, botG); ctx.lineTo(cx+barW+gap, botG); ctx.stroke();
    ctx.fillStyle = var_crimson; ctx.font='bold 11px Inter'; ctx.textAlign='left';
    ctx.fillText(gapPts+'pt gap', cx+barW+gap+14, (topG+botG)/2+4);
  }

  ctx.fillStyle = var_black; ctx.font='bold 14px VTC Du Bois, serif'; ctx.textAlign='center';
  ctx.fillText('Professional/Management Representation', W/2, 24);

  drawPair(W*0.28, 10, 1, '1900', '9');
  drawPair(W*0.72, 44, 36, '2023', '8');
}

// ===== QUIZ =====
const quizData = [
  {q:"What was \"the problem of the 20th century\" according to Du Bois?",opts:["Economic inequality","The color line","Immigration","Industrialization"],correct:1,expl:"Du Bois wrote that \"the problem of the twentieth century is the problem of the color line\" â€” racial division was the defining challenge."},
  {q:"How many hand-drawn charts did Du Bois present at the Paris Exhibition?",opts:["12","28","63","100"],correct:2,expl:"Du Bois and his students at Atlanta University created 63 stunning, hand-drawn charts, graphs, and maps."},
  {q:"What percentage of Black Americans lived in the South in 1900?",opts:["50%","70%","80%","90%"],correct:3,expl:"90% of all Black Americans lived in the South â€” a direct legacy of where slavery had existed."},
  {q:"What drove the Great Migration (1916â€“1970)?",opts:["Gold rush opportunities","Escaping Jim Crow and finding better jobs","Government relocation programs","Railroad expansion"],correct:1,expl:"Over 6 million people moved north and west to escape Jim Crow laws and find better jobs in industrial cities."},
  {q:"Which education gap is WIDENING rather than closing?",opts:["High school completion","Literacy rates","Bachelor's degree attainment","Elementary enrollment"],correct:2,expl:"The bachelor's degree gap widened from 3.6 to 12.5 points, largely due to cost barriers and structural inequality."},
  {q:"What percentage of Black workers were in Professional roles in 1900?",opts:["1%","5%","10%","25%"],correct:0,expl:"Only 1% of Black workers were in professional roles in 1900. By 2023, that had risen to 36% â€” a 36-fold increase."},
  {q:"What was the 36-fold increase?",opts:["Population growth","Agricultural output","Professional representation (1% to 36%)","Voting rates"],correct:2,expl:"Professional/Management representation skyrocketed from 1% in 1900 to 36% in 2023."},
  {q:"How has the professional gap between Black and White workers changed since 1900?",opts:["It closed completely","It barely changed (9pts to 8pts)","It doubled","It tripled"],correct:1,expl:"Despite a 36-fold increase in Black professional representation, the gap barely changed â€” from 9 points to 8 points â€” because White representation also grew."}
];

let curQ=0,score=0,answered=false;

function initQuiz(){
  const cont=document.getElementById('qContainer');
  cont.innerHTML='';
  quizData.forEach((q,i)=>{
    let h=`<div class="q-card ${i===0?'active':''}" id="qc${i}"><div class="q-text">${i+1}. ${q.q}</div><div class="q-opts">`;
    q.opts.forEach((o,j)=>{h+=`<div class="q-opt" onclick="pickQ(${i},${j})" id="qo${i}_${j}">${o}</div>`;});
    h+=`</div><div class="q-fb" id="qfb${i}"></div><button class="q-next" id="qn${i}" onclick="nextQ()">Next</button></div>`;
    cont.innerHTML+=h;
  });
  document.getElementById('qBar').style.width='0%';
}

function pickQ(qi,oi){
  if(answered)return;answered=true;
  const q=quizData[qi],fb=document.getElementById('qfb'+qi);
  document.querySelectorAll(`#qc${qi} .q-opt`).forEach((o,i)=>{if(i===q.correct)o.classList.add('correct');if(i===oi&&i!==q.correct)o.classList.add('wrong');});
  if(oi===q.correct){score++;fb.textContent='Correct! '+q.expl;fb.className='q-fb show ok';sfxSuccess();}
  else{fb.textContent='Not quite. '+q.expl;fb.className='q-fb show no';sfxClick();}
  document.getElementById('qn'+qi).style.display='inline-block';
}

function nextQ(){
  document.getElementById('qc'+curQ).classList.remove('active');
  curQ++;answered=false;
  if(curQ<quizData.length){document.getElementById('qc'+curQ).classList.add('active');document.getElementById('qBar').style.width=(curQ/quizData.length*100)+'%';}
  else showQuizScore();
}

let quizPct=0,quizRank='';
function showQuizScore(){
  document.getElementById('qContainer').style.display='none';
  document.getElementById('qScore').style.display='block';
  document.getElementById('qBar').style.width='100%';
  const pct=Math.round(score/quizData.length*100);
  quizPct=pct;
  let t,txt;
  if(pct>=90){t='Data Analyst!';txt=`${score}/${quizData.length} â€” Outstanding work. Du Bois would approve.`;}
  else if(pct>=70){t='Research Fellow';txt=`${score}/${quizData.length} â€” Strong analysis skills.`;}
  else if(pct>=50){t='Research Assistant';txt=`${score}/${quizData.length} â€” Review the data and try again.`;}
  else{t='Intern';txt=`${score}/${quizData.length} â€” Go back through the evidence!`;}
  quizRank=t;
  document.getElementById('scoreTitle').textContent=t;
  document.getElementById('scoreText').textContent=txt;
  document.getElementById('getCertBtn').style.display='inline-block';
  sfxCelebration();
  if(pct>=70)awardBadge('data-analyst');
}

function restartQuiz(){
  curQ=0;score=0;answered=false;
  document.getElementById('qScore').style.display='none';
  document.getElementById('qContainer').style.display='block';
  initQuiz();
}
initQuiz();

// ===== SOUND SYSTEM =====
const AudioCtx = window.AudioContext || window.webkitAudioContext;
let audioCtx = null;
let soundMuted = localStorage.getItem('dubois-sound-muted') === 'true';
function ensureAudio(){if(!audioCtx)audioCtx=new AudioCtx();}
function updateSoundBtn(){document.getElementById('soundToggle').innerHTML=soundMuted?'&#128263;':'&#128264;';}
updateSoundBtn();
function toggleSound(){soundMuted=!soundMuted;localStorage.setItem('dubois-sound-muted',soundMuted);updateSoundBtn();}
function playTone(freq,dur,type){
  if(soundMuted)return;ensureAudio();
  const o=audioCtx.createOscillator(),g=audioCtx.createGain();
  o.type=type||'sine';o.frequency.value=freq;
  g.gain.setValueAtTime(0.15,audioCtx.currentTime);
  g.gain.exponentialRampToValueAtTime(0.001,audioCtx.currentTime+dur/1000);
  o.connect(g);g.connect(audioCtx.destination);o.start();o.stop(audioCtx.currentTime+dur/1000);
}
function sfxClick(){playTone(800,50,'sine');}
function sfxSuccess(){
  if(soundMuted)return;ensureAudio();
  [523,659,784].forEach((f,i)=>setTimeout(()=>playTone(f,100,'sine'),i*100));
}
function sfxCelebration(){
  if(soundMuted)return;ensureAudio();
  [523,659,784,1047].forEach((f,i)=>setTimeout(()=>playTone(f,80,'sine'),i*70));
}

// ===== BADGE SYSTEM =====
const badgeDefs=[
  {id:'color-line',name:'Color Line Scholar',icon:'&#127752;',desc:'Completed Section 1'},
  {id:'myth-buster',name:'Myth Buster',icon:'&#128165;',desc:'Flipped both pseudoscience cards'},
  {id:'map-reader',name:'Map Reader',icon:'&#128506;',desc:'Viewed the 1900 map'},
  {id:'migration-expert',name:'Migration Expert',icon:'&#128747;',desc:'Explored all 3 migration tabs'},
  {id:'gap-analyst',name:'Gap Analyst',icon:'&#128200;',desc:'Viewed both absolute and gap charts'},
  {id:'data-analyst',name:'Data Analyst',icon:'&#128202;',desc:'Scored 70%+ on the quiz'},
  {id:'vocab-master',name:'Vocab Master',icon:'&#128218;',desc:'Flipped all 6 flashcards'}
];
let earnedBadges=JSON.parse(localStorage.getItem('dubois-badges')||'[]');
function renderBadges(){
  const list=document.getElementById('badgeList');if(!list)return;
  list.innerHTML=badgeDefs.map(b=>{
    const earned=earnedBadges.includes(b.id);
    return `<div class="badge-item ${earned?'earned':'locked'}"><div class="badge-icon">${b.icon}</div><div class="badge-info"><h4>${b.name}${earned?' &#10003;':''}</h4><p>${b.desc}</p></div></div>`;
  }).join('');
}
renderBadges();
function awardBadge(id){
  if(earnedBadges.includes(id))return;
  earnedBadges.push(id);localStorage.setItem('dubois-badges',JSON.stringify(earnedBadges));
  renderBadges();
  const b=badgeDefs.find(x=>x.id===id);if(!b)return;
  sfxCelebration();
  const toast=document.getElementById('badgeToast');
  toast.innerHTML=`${b.icon} Badge Earned: <strong>${b.name}</strong>`;
  toast.classList.add('show');setTimeout(()=>toast.classList.remove('show'),3000);
}
function toggleBadgeDrawer(){document.getElementById('badgeDrawer').classList.toggle('open');}

// Badge tracking state
let migTabsViewed=new Set(['then4']);
let flipCardsFlipped=new Set();
let viewsViewed=new Set(['absolute']);
let vocabFlipped=new Set();

// ===== DRAG AND DROP =====
(function initDnD(){
  const chips=document.querySelectorAll('.dnd-chip');
  const zones=document.querySelectorAll('.dnd-zone');
  let draggedEl=null;
  let correctCount=0;
  chips.forEach(chip=>{
    chip.addEventListener('dragstart',e=>{draggedEl=chip;e.dataTransfer.effectAllowed='move';setTimeout(()=>chip.style.opacity='.4',0);sfxClick();});
    chip.addEventListener('dragend',()=>{chip.style.opacity='1';});
    // Touch support
    chip.addEventListener('touchstart',e=>{draggedEl=chip;chip.style.opacity='.6';},{passive:true});
    chip.addEventListener('touchend',e=>{
      chip.style.opacity='1';
      if(!draggedEl)return;
      const touch=e.changedTouches[0];
      const target=document.elementFromPoint(touch.clientX,touch.clientY);
      const zone=target?target.closest('.dnd-zone'):null;
      if(zone)handleDrop(zone);
      draggedEl=null;
    });
  });
  zones.forEach(zone=>{
    zone.addEventListener('dragover',e=>{e.preventDefault();zone.classList.add('over');});
    zone.addEventListener('dragleave',()=>zone.classList.remove('over'));
    zone.addEventListener('drop',e=>{e.preventDefault();zone.classList.remove('over');handleDrop(zone);});
  });
  function handleDrop(zone){
    if(!draggedEl)return;
    const factor=draggedEl.dataset.factor;
    const correct=draggedEl.dataset.target;
    const zoneType=zone.dataset.zone;
    const div=document.createElement('div');
    div.className='dnd-dropped';
    div.textContent=factor;
    if(zoneType===correct){
      div.classList.add('correct');draggedEl.classList.add('placed');
      correctCount++;sfxSuccess();
      if(correctCount>=6){document.getElementById('dndComplete').style.display='block';sfxCelebration();}
    } else {
      div.classList.add('wrong');
      setTimeout(()=>div.remove(),800);
      sfxClick();
    }
    zone.appendChild(div);draggedEl=null;
  }
})();

// ===== TYPEWRITER =====
let heroTyped=false,closingTyped=false;
function typewrite(el,delay){
  const text=el.getAttribute('data-typewriter');if(!text)return;
  el.innerHTML='';
  const span=document.createElement('span');span.className='typewriter-text';
  const cursor=document.createElement('span');cursor.className='typewriter-cursor';
  el.appendChild(span);el.appendChild(cursor);
  let i=0;
  function tick(){
    if(i<text.length){
      if(text.substr(i,1)==='&'){const end=text.indexOf(';',i);if(end!==-1){const tmp=document.createElement('span');tmp.innerHTML=text.substring(i,end+1);span.textContent+=tmp.textContent;i=end+1;}else{span.textContent+=text[i];i++;}}
      else{span.textContent+=text[i];i++;}
      setTimeout(tick,40);
    } else {setTimeout(()=>cursor.remove(),2000);}
  }
  setTimeout(tick,delay||0);
}
// Hero: typewrite on load with 1.5s delay
setTimeout(()=>{const hq=document.getElementById('heroQuote');if(hq&&!heroTyped){heroTyped=true;typewrite(hq,0);}},1500);

// ===== CERTIFICATE =====
// quizPct and quizRank declared near showQuizScore
function openCert(){document.getElementById('certOverlay').classList.add('open');sfxClick();}
function closeCert(){document.getElementById('certOverlay').classList.remove('open');}
function generateCert(){
  const name=document.getElementById('certName').value.trim();if(!name){document.getElementById('certName').style.borderColor='var(--red-accent)';return;}
  document.getElementById('certForm').style.display='none';
  document.getElementById('certResult').style.display='block';
  document.getElementById('certDisplayName').textContent=name;
  document.getElementById('certScore').textContent=score+'/'+quizData.length+' ('+quizPct+'%)';
  document.getElementById('certRank').textContent=quizRank;
  document.getElementById('certDate').textContent=new Date().toLocaleDateString('en-US',{year:'numeric',month:'long',day:'numeric'});
  sfxCelebration();
}

// ===== PARALLAX =====
function updateParallax(){
  document.querySelectorAll('[data-parallax]').forEach(div=>{
    const rect=div.getBoundingClientRect();
    const svg=div.querySelector('.parallax-svg');
    if(svg&&rect.top<window.innerHeight&&rect.bottom>0){
      const offset=(rect.top-window.innerHeight/2)*0.3;
      svg.style.transform='translateY('+offset+'px)';
    }
  });
}
window.addEventListener('scroll',updateParallax,{passive:true});
updateParallax();

// ===== SVG BORDER ANIMATION =====
const borderObs=new IntersectionObserver(entries=>{
  entries.forEach(e=>{
    if(e.isIntersecting){
      e.target.querySelectorAll('.svg-border-art').forEach(s=>s.classList.add('animated'));
    }
  });
},{threshold:0.2});
document.querySelectorAll('.svg-border-target').forEach(el=>borderObs.observe(el));

// ===== CLOSING QUOTE SCROLL TYPEWRITER =====
const closingObs=new IntersectionObserver(entries=>{
  entries.forEach(e=>{
    if(e.isIntersecting&&!closingTyped){
      closingTyped=true;
      typewrite(document.getElementById('closingQuote'),0);
      closingObs.disconnect();
    }
  });
},{threshold:0.3});
const cqEl=document.getElementById('closingQuote');
if(cqEl)closingObs.observe(cqEl);

// ===== BADGE: SECTION 1 COMPLETION =====
const sec1Obs=new IntersectionObserver(entries=>{
  entries.forEach(e=>{if(e.isIntersecting){awardBadge('color-line');sec1Obs.disconnect();}});
},{threshold:0.5});
const sec1El=document.getElementById('sec2');
if(sec1El)sec1Obs.observe(sec1El);

// ===== BADGE: MAP READER =====
const mapObs2=new IntersectionObserver(entries=>{
  entries.forEach(e=>{if(e.isIntersecting){awardBadge('map-reader');mapObs2.disconnect();}});
},{threshold:0.3});
const mapC=document.getElementById('mapCanvas');
if(mapC)mapObs2.observe(mapC);

// ===== FLASHCARDS =====
const vocabTerms=[
  {t:'Data Visualization',d:'The graphical representation of information to reveal patterns and insights.'},
  {t:'Pseudoscience',d:'Beliefs mistakenly regarded as based on the scientific method. Du Bois fought this with real data.'},
  {t:'Empirical Data',d:'Evidence collected through direct observation and measurement.'},
  {t:'Structural Inequality',d:'When societal systems and institutions produce unequal outcomes for different groups.'},
  {t:'Absolute Progress',d:'An increase in a metric for a group over time (e.g., higher income).'},
  {t:'Relative Gap (Parity)',d:'The difference between two groups for a given metric (e.g., the wealth gap).'}
];
let fcIdx=0;
function updateFC(){
  document.getElementById('fcTerm').textContent=vocabTerms[fcIdx].t;
  document.getElementById('fcDef').textContent=vocabTerms[fcIdx].d;
  document.getElementById('fcCard').classList.remove('show-def');
  document.getElementById('fcCount').textContent=(fcIdx+1)+'/'+vocabTerms.length;
}
function fcNav(dir){fcIdx=(fcIdx+dir+vocabTerms.length)%vocabTerms.length;updateFC();}
updateFC();
</script>
</body>
</html>
